{"version":3,"sources":["components/PlayerBuilder.tsx","hooks/useScroll.tsx","components/EncounterBuilder.tsx","components/menus/Menu.tsx","geneticalgorithm/geneticalgorithm.js","game/tinkerer.ts","components/Enemy.tsx","components/Player.tsx","components/Game.tsx","hooks/useForceRerender.tsx","hooks/usePressedKeys.tsx","components/SingleGame.tsx","components/menus/LoadScreen.tsx","App.tsx","reportWebVitals.ts","components/GameInfoBar.tsx","index.tsx","game/effectRepository.ts","game/playGame.ts","game/data/enemies.ts","game/data/armors.ts","game/data/charms.ts","game/data/classes.ts","game/data/consumables.ts","game/data/footwears.ts","game/data/headgears.ts","game/data/offhand.ts","game/data/skills.ts","game/data/weapons.ts","game/data/build.ts","game/data.ts","game/zFunDump.ts","game/modding.ts","game/types.ts","game/data/names.ts","game/makeGame.ts","stateMachines/menuStateMachine.ts","serviceWorkerRegistration.ts"],"names":["systemBuildKeys","Set","ElementPicker","isSelected","section","options","setField","scrollParams","elRef","useRef","current","scrollIntoView","useScroll","behavior","block","scrollTo","scrollRef","Row","Card","Title","chunk","map","itemChunk","idx","ButtonGroup","size","className","item","Button","name","id","display","variant","onClick","ref","PlayerBuilder","onSave","randomPlayer","player","playerStats","React","useState","build","form","setForm","lore","setLore","displayType","type","postBuildPlayerStats","buildPlayer","randomEnemy","Form","onSubmit","e","preventDefault","Container","fluid","safeEntries","values","has","value","field","safeValues","Navbar","fixed","bg","style","maxHeight","Text","randomName","hp","stamina","staminaPerTurn","attack","defence","speed","EncounterBuilder","encounter","setEncounter","enemies","a","enemiesStats","enemy","disabled","length","marginBottom","found","filter","m","_","Menu","title","states","state","geneticAlgorithmConstructor","settingWithDefaults","settings","defaults","mutationFunction","crossoverFunction","fitnessFunction","doesABeatBFunction","population","Error","populationSize","phenotype","b","undefined","cloneJSON","object","JSON","parse","stringify","mutate","crossover","mate","Math","floor","random","evolve","rand","push","populate","index","otherIndex","temp","randomizePopulationOrder","nextGeneration","p","competitor","compete","this","best","scored","scoredPopulation","reduce","score","bestScore","config","clone","defaultTinkererOptions","playerSeed","weights","monster","turn","debug","findBestPlay","play","iter","optionsOverride","Chance","initStats","startState","initialState","startPlayerHealth","max","startPlayerStamina","startMonsterHealth","acc","startStats","oldPlay","latestState","previousState","monsterHealth","turns","newPlay","d6","target","setSelected","natural","min","latest","actions","playerActions","inventory","unavailable","handlePlayerEffect","exclude","playerHealth","playerStamina","monsterKillingFitness","playerAlivenessFitness","killSpeedFitness","staminaFitness","fitness","console","log","scorePlay","gen","GeneticAlgorithmConstructor","i","Seq","sortBy","toArray","EnemyCard","effects","enemyStats","onSelect","latestAttack","canAct","hotkey","toUpperCase","Body","distance","status","bleed","rolls","countBy","v","find","range","priority","tooltip","OverlayTrigger","placement","delay","show","hide","overlay","props","Popover","Header","as","join","toFixed","PlayerCard","selectedButtons","inventoryStats","onClickEffect","lastAction","disabledSkills","setDisabledSkills","hotkeys","passives","k","bot","eot","count","sta","s","passiveCount","passiveStamina","hasPassives","Subtitle","class","effs","ToggleButton","checked","onChange","event","currentTarget","delete","add","playerItemActions","groupBy","active","clamp","playerHotkeys","Game","game","solveGame","timeTravel","hint","onMenu","onGameEnd","lastAttacks","isLogShown","setShowLog","forceUpdate","setValue","useForceRerender","useEffect","updateGlobals","ingame","playerSkills","gameState","playState","handleCloseLog","pressed","onUp","pressedKeys","updatePressedKeys","downHandler","key","set","upHandler","useCallback","window","addEventListener","removeEventListener","usePressedKeys","save","undo","redo","indexOf","skillNumber","valNum","parseInt","flatMap","skillIndex","blob","Blob","saveAs","Date","now","Col","CardGroup","zip","stats","Enemy","origin","phase","Player","Modal","onHide","scrollable","centered","closeButton","Footer","SingleGame","setGame","setRedo","timeTravelObj","newRedo","pop","slice","iterations","maxBy","LoadScreen","onLoad","loadError","setLoadError","load","data","playRaw","fileData","files","reader","FileReader","onloadend","ev","result","readAsText","rawData","Alert","Group","Label","Control","accept","muted","rows","placeholder","App","useMachine","gameMenuMachine","devTools","send","matches","Object","keys","main","on","quick","makeGameNew","context","singleContext","seed","single","training","dummyEnemy","arcade","survivalContext","arcadeContext","victories","otherEnemy","firstState","makeGameNextLevel","survival","lastState","replay","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","GameInfoBar","areRulesShown","showRules","xs","href","fullscreen","container","document","getElementById","createRoot","render","StrictMode","serviceWorkerRegistration","effectFun","fun","params","oldState","engineFunctions","currentState","_origin","pipe","changeStatusPlayer","o","armor","amount","dodge","stun","newState","changeStatusMonster","effectFunRepo","changeDistance","attackMonster","modifyPlayerStamina","changeStatPlayer","gameTarget","applyPoison","changeStatMonster","attackPlayer","addEnemy","_m","addBotEffect","allRanges","interruptible","effectFunCall","updateMonster","override","updatePlayer","curr","damage","afterDefence","afterArmor","armorSpent","afterBleed","f","updateStatus","removeMonster","currPlay","currSnap","modify","updatePlayerStat","addEotEffect","effect","statsRepository","makeStat","turnDeterministicRng","randPerTurn","monsterSeed","monsterChance","rangeArr","floating","used","playerPassives","playerGameStats","enemyGameStats","rng","toIndexableString","version","reduceFuns","funs","priorityBonus","monsterId","targetMonster","isStunnedPlayer","isStunnedMonster","parameters","callEffectFun","extractFunction","effectEotCleanup","effectDead","d","lastTurnState","usedSkill","postBotPlay","postBotState","playerBotEffs","entitiesBot","eff","postEntitiesBotPlay","postEntitiesBotState","turnRng","turnFunctions","roll","concat","playerEotEffs","playerEotEffects","entitiesEot","enemiesEotEffects","postPlayerEotPlay","postPlayerEotState","postEotPlay","postEotState","passivesStamina","postStaminaPlay","postStaminaState","postCleanup","postCleanupState","scoreGame","hpLoss","staminaLoss","piripuru","selfRange","makeRange","defaultStatus","toros","description","purupuri","ninkujorua","tshopuritazios","armors","heavy","medium","light","none","charms","health","haste","resilience","strength","swiftness","classes","warrior","rogue","berserk","mage","cleric","consumables","healing","razors","bubble","rock","footwears","slippers","boots","greaves","headgears","helm","cap","magehat","offhands","hook","parry","shield","focus","wand","skills","sturdy","nimble","resourceful","weapons","sword","greatsword","twinblades","katana","axe","lance","hammer","claw","bow","staff","enabled","basic","skill","weapon","offhand","headgear","footwear","charm","consumable","enemyRepository","Array","num","Infinity","t","list","chunkSize","Range","chunkStart","globalsDefault","trainingEnemy","starting","globals","globalThis","theThis","__buildmancer","isArray","repo","entries","names","number","amt","pickone","randomBuild","buildOverride","playerStatsDefault","statsOverride","string","age","isDebug","process","inspect","server","WebSocket","Server","port","toMenu","MENU","initial","entry","WIN","LOSE","win","lose","PLAYER","ENCOUNTER","cond","internal","victory","defeat","puzzle","SELECTED","COMPLETE","complete","NEXT","SELECT","REPLAY","makeArcadeContext","makeSurvivalContext","makeSingleContext","createMachine","tsTypes","QUICK","SINGLE","TRAINING","ARCADE","SURVIVAL","guards","isFinal","bumpVictories","assign","_event","bumpScore","reset","c","interpret","onTransition","start","isLocalhost","Boolean","location","hostname","match","register","navigator","URL","swUrl","fetch","headers","response","contentType","get","serviceWorker","ready","registration","unregister","reload","registerValidSW","catch","checkValidServiceWorker","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","error"],"mappings":"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A,SACA,QACA,WACA,QACA,QACA,SACA,QACA,SACA,SACA,SACA,SACA,UACA,SACA,SACA,SACA,OACA,QACA,OACA,QACA,MACA,SACA,SACA,OACA,UACA,QACA,UACA,SACA,UACA,QACA,SACA,SACA,UACA,SACA,OACA,QACA,SACA,SACA,UACA,QACA,OACA,UACA,OACA,SACA,SACA,QACA,UACA,SACA,SACA,OACA,QACA,QACA,SACA,QACA,QACA,SACA,SACA,OACA,OACA,SACA,QACA,QACA,UACA,SACA,QACA,UACA,UACA,UACA,WACA,QACA,WACA,QACA,SACA,SACA,OACA,SACA,QACA,QACA,OACA,WACA,SACA,QACA,UACA,SACA,UACA,SACA,SACA,SACA,SACA,QACA,QACA,OACA,OACA,QACA,QACA,WACA,QACA,UACA,SACA,UACA,QACA,OACA,OACA,OACA,SACA,WACA,OACA,OACA,QACA,MACA,SACA,OACA,UACA,QACA,UACA,SACA,MACA,UACA,QACA,SACA,QACA,SACA,QACA,QACA,QACA,QACA,SACA,QACA,QACA,SACA,QACA,OACA,QACA,SACA,SACA,UACA,QACA,QACA,QACA,OACA,QACA,OACA,QACA,SACA,SACA,QACA,QACA,QACA,QACA,QACA,UACA,UACA,QACA,QACA,QACA,UACA,SACA,QACA,SACA,UACA,SACA,QACA,OACA,SACA,QACA,OACA,UACA,QACA,SACA,UACA,SACA,MACA,QACA,OACA,MACA,QACA,YACA,OACA,QACA,QACA,SACA,QACA,QACA,SACA,QACA,SACA,UACA,U,eCpLWtF,EAAY,sCAAIuF,EAAJ,yBAAIA,EAAJ,mCACnB,IAAIrlB,IAAIqlB,KACDvK,EAAYgF,EAAU,EAAG,EAAG,EAAG,EAAG,GAClCD,EAAY/E,EAEZsB,EAAW,SACtBvC,GADsB,IAEtBlQ,EAFsB,uDAES,SAAC2b,GAAD,OAASA,EAAM,IAFxB,MAGZ,CACV7kB,QAASoZ,EACT+K,SAAU/K,EACVlQ,IAAKA,EAAIkQ,KAEEkG,EAAwB,CACnCjG,MA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","file":"static/js/main.050f651d.chunk.js","sourcesContent":["import React from 'react';\nimport { Container, Row, Form, Button, ButtonGroup, Navbar, Card } from 'react-bootstrap';\nimport useScroll from '../hooks/useScroll';\nimport { Build, Item, Player, PlayerStats, safeEntries, safeValues } from '../game/types';\nimport { build } from '../game/data';\nimport { Set } from 'immutable';\nimport { buildPlayer } from '../game/playGame';\nimport { randomPlayer, randomEnemy, randomName } from '../game/makeGame';\nimport { chunk } from '../game/zFunDump';\n\nconst systemBuildKeys: Set<keyof Build> = Set(['debug', 'basic']);\n\nconst PlayerBuilder = ({\n  onSave,\n}: {\n  onSave: (player: Player, playerStats: PlayerStats) => void;\n}) => {\n  const [player, playerStats] = randomPlayer();\n  const [form, setForm] = React.useState<Build>(player.build);\n  const [lore, setLore] = React.useState(player.lore);\n  const setField = <T extends keyof Build>(field: T, value: Build[T]) => {\n    setForm({\n      ...form,\n      [field]: value,\n    });\n  };\n  const onFormSubmit = (e: any) => {\n    e.preventDefault();\n    onSave(\n      {\n        id: 'p-1',\n        lore,\n        build: form,\n      },\n      playerStats\n    );\n  };\n  const displayType = (type: keyof Build) => <b>{form[type].display}</b>;\n\n  const postBuildPlayerStats = buildPlayer({ ...player, build: form }, playerStats, [\n    randomEnemy()[1],\n  ])[0];\n\n  return (\n    <Form onSubmit={onFormSubmit}>\n      <Container fluid>\n        {safeEntries(build).map(\n          ([type, values]) =>\n            !systemBuildKeys.has(type) && (\n              <ElementPicker\n                setField={(value) => setField(type, value)}\n                section={type}\n                options={safeValues<{ [k: string]: Item }, string>(values)}\n                key={type}\n                isSelected={(value) => form[type].display === value.display}\n              />\n            )\n        )}\n        <Navbar fixed=\"bottom\" bg=\"dark\" variant=\"dark\" style={{ maxHeight: '115px' }}>\n          <Container>\n            <Navbar.Text>\n              You are{' '}\n              <i onClick={() => setLore((lore) => ({ ...lore, name: randomName() }))}>\n                {lore.name}\n              </i>\n              , the {displayType('skill')} {displayType('class')} {displayType('charm')}\n              <br />\n              who wields a {displayType('weapon')} and a {displayType('offhand')}\n              <br />\n              and wears {displayType('armor')} with {displayType('headgear')} and{' '}\n              {displayType('footwear')}\n            </Navbar.Text>\n            <Navbar.Text>\n              {postBuildPlayerStats.hp.current} ❤\n              <br />\n              {postBuildPlayerStats.stamina.current} 💪 (\n              {postBuildPlayerStats.staminaPerTurn.current >= 0 && '+'}\n              {postBuildPlayerStats.staminaPerTurn.current})<br />\n              Attack {postBuildPlayerStats.attack.current} | Defence{' '}\n              {postBuildPlayerStats.defence.current} | Speed {postBuildPlayerStats.speed.current}\n            </Navbar.Text>\n            <Button type=\"submit\">This is me!</Button>\n          </Container>\n        </Navbar>\n      </Container>\n    </Form>\n  );\n};\n\nconst ElementPicker = ({\n  isSelected,\n  section,\n  options,\n  setField,\n}: {\n  options: Item[];\n  isSelected: (value: Item) => boolean;\n  setField: (value: Item) => void;\n  section: string;\n}) => {\n  const [scrollTo, scrollRef] = useScroll({\n    behavior: 'smooth',\n    block: 'start',\n  });\n\n  return (\n    <Row>\n      <Card.Title>{section}</Card.Title>\n      {chunk(options, 4).map((itemChunk, idx) => (\n        <ButtonGroup size=\"lg\" className=\"mb-2\" key={idx}>\n          {itemChunk.map((item) => (\n            <Button\n              key={item.display}\n              name={section}\n              id={`${item.display}`}\n              variant={isSelected(item) ? 'primary' : 'secondary'}\n              onClick={() => {\n                setField(item);\n                scrollTo();\n              }}\n            >\n              {item.display}\n            </Button>\n          ))}\n        </ButtonGroup>\n      ))}\n      <div id={`${section}-scroll`} ref={scrollRef} />\n    </Row>\n  );\n};\n\nexport default PlayerBuilder;\n","import { Ref, useRef } from 'react';\n\ntype ScrollToFn = () => void;\n\nexport default function useScroll<T extends Element>(\n  scrollParams: ScrollIntoViewOptions\n): [ScrollToFn, Ref<any>] {\n  const elRef = useRef<T>(null);\n  const executeScroll = () => elRef.current!.scrollIntoView(scrollParams);\n\n  return [executeScroll, elRef];\n}\n","import React from 'react';\nimport { Container, ButtonGroup, Form, Button, Navbar } from 'react-bootstrap';\nimport {\n  Player,\n  Enemies,\n  EnemiesStats,\n  Build,\n  EnemyInfo,\n  safeValues,\n  PlayerStats,\n} from '../game/types';\nimport { enemies } from '../game/data';\nimport { randomEnemy } from '../game/makeGame';\n\nconst EncounterBuilder = ({\n  player,\n  onSave,\n}: {\n  player: [Player, PlayerStats];\n  onSave: (enemies: Enemies, enemiesStats: EnemiesStats) => void;\n}) => {\n  const [encounter, setEncounter] = React.useState<EnemyInfo[]>([]);\n  const onFormSubmit = (e: any) => {\n    e.preventDefault();\n    const enemies = encounter.map((a) => a[0]);\n    const enemiesStats = encounter.map((a) => a[1]);\n    // Size enforced by UI\n    onSave(enemies as Enemies, enemiesStats as EnemiesStats);\n  };\n  const displayType = (type: keyof Build) => <b>{player[0].build[type].display}</b>;\n  return (\n    <Form onSubmit={onFormSubmit}>\n      <Container fluid>\n        <ButtonGroup size=\"lg\" className=\"mb-2\">\n          {safeValues(enemies).map((enemy) => (\n            <Button\n              key={enemy[0].lore.name}\n              disabled={encounter.length > 4}\n              onClick={() => setEncounter((e) => [...e, enemy])}\n            >\n              {enemy[0].lore.name}\n            </Button>\n          ))}\n        </ButtonGroup>\n      </Container>\n      {encounter.length > 0 && (\n        <Navbar fixed=\"bottom\" bg=\"dark\" variant=\"dark\" style={{ marginBottom: '100px' }}>\n          <Container fluid>\n            <ButtonGroup size=\"sm\" className=\"mb-2\">\n              {encounter.map((enemy, idx) => (\n                <Button\n                  key={`${enemy[0].lore.name}-${idx}`}\n                  onClick={() =>\n                    setEncounter((e) => {\n                      let found = false;\n                      return e.filter(\n                        (m) => found || m[0].lore.name !== enemy[0].lore.name || !(found = true)\n                      );\n                    })\n                  }\n                >\n                  {enemy[0].lore.name}\n                </Button>\n              ))}\n            </ButtonGroup>\n          </Container>\n        </Navbar>\n      )}\n      <Navbar fixed=\"bottom\" bg=\"dark\" variant=\"dark\" style={{ maxHeight: '100px' }}>\n        <Container>\n          <Navbar.Text>\n            You are <i>{player[0].lore.name}</i>, the {displayType('skill')} {displayType('class')}{' '}\n            {displayType('charm')}\n            <br />\n            {player[1].hp.current} ❤\n            <br />\n            {player[1].stamina.current} 💪 ({player[1].staminaPerTurn.current >= 0 && '+'}\n            {player[1].staminaPerTurn.current})<br />\n            Attack {player[1].attack.current} | Defence {player[1].defence.current} | Speed{' '}\n            {player[1].speed.current}\n          </Navbar.Text>\n          <ButtonGroup>\n            <Button\n              disabled={encounter.length < 0 || encounter.length > 4}\n              onClick={(_) => setEncounter((e) => [...e, randomEnemy()])}\n            >\n              Add Random\n            </Button>\n            <Button type=\"submit\" disabled={encounter.length < 1 || encounter.length > 5}>\n              To Battle!\n            </Button>\n          </ButtonGroup>\n        </Container>\n      </Navbar>\n    </Form>\n  );\n};\n\nexport default EncounterBuilder;\n","import React from 'react';\nimport { Container, Card, Row, Button } from 'react-bootstrap';\n\nconst Menu: React.FC<{\n  title: string;\n  states: string[];\n  onClick: (value: string) => void;\n}> = ({ title, states, onClick }) => (\n  <Container fluid style={{ marginBottom: '105px' }}>\n    <Row className=\"g-2\">\n      <Card.Title>{title}</Card.Title>\n    </Row>\n    {states.map((state) => (\n      <Row className=\"g-2\" key={state}>\n        <Button\n          size=\"lg\"\n          className=\"mb-2\"\n          key={state}\n          variant={'primary'}\n          onClick={() => {\n            onClick(state);\n          }}\n        >\n          {state}\n        </Button>\n      </Row>\n    ))}\n  </Container>\n);\n\nexport default Menu;\n","export default function geneticAlgorithmConstructor(options) {\n  function settingDefaults() {\n    return {\n      mutationFunction: function (phenotype) {\n        return phenotype;\n      },\n\n      crossoverFunction: function (a, b) {\n        return [a, b];\n      },\n\n      fitnessFunction: function (phenotype) {\n        return 0;\n      },\n\n      doesABeatBFunction: undefined,\n\n      population: [],\n      populationSize: 100,\n    };\n  }\n\n  function settingWithDefaults(settings, defaults) {\n    settings = settings || {};\n\n    settings.mutationFunction = settings.mutationFunction || defaults.mutationFunction;\n    settings.crossoverFunction = settings.crossoverFunction || defaults.crossoverFunction;\n    settings.fitnessFunction = settings.fitnessFunction || defaults.fitnessFunction;\n\n    settings.doesABeatBFunction = settings.doesABeatBFunction || defaults.doesABeatBFunction;\n\n    settings.population = settings.population || defaults.population;\n    if (settings.population.length <= 0)\n      throw Error('population must be an array and contain at least 1 phenotypes');\n\n    settings.populationSize = settings.populationSize || defaults.populationSize;\n    if (settings.populationSize <= 0) throw Error('populationSize must be greater than 0');\n\n    return settings;\n  }\n\n  var settings = settingWithDefaults(options, settingDefaults());\n\n  function populate() {\n    var size = settings.population.length;\n    while (settings.population.length < settings.populationSize) {\n      const rand = Math.floor(Math.random() * size);\n      settings.population.push(mutate(cloneJSON(settings.population[Math.floor(rand)])));\n    }\n  }\n\n  function cloneJSON(object) {\n    return JSON.parse(JSON.stringify(object));\n  }\n\n  function mutate(phenotype) {\n    return settings.mutationFunction(cloneJSON(phenotype));\n  }\n\n  function crossover(phenotype) {\n    phenotype = cloneJSON(phenotype);\n    var mate = settings.population[Math.floor(Math.random() * settings.population.length)];\n    mate = cloneJSON(mate);\n    return settings.crossoverFunction(phenotype, mate)[0];\n  }\n\n  function doesABeatB(a, b) {\n    if (settings.doesABeatBFunction) {\n      return settings.doesABeatBFunction(a, b);\n    } else {\n      return settings.fitnessFunction(a) >= settings.fitnessFunction(b);\n    }\n  }\n\n  function compete() {\n    var nextGeneration = [];\n\n    for (var p = 0; p < settings.population.length - 1; p += 2) {\n      var phenotype = settings.population[p];\n      var competitor = settings.population[p + 1];\n\n      nextGeneration.push(phenotype);\n      if (doesABeatB(phenotype, competitor)) {\n        if (Math.random() < 0.5) {\n          nextGeneration.push(mutate(phenotype));\n        } else {\n          nextGeneration.push(crossover(phenotype));\n        }\n      } else {\n        nextGeneration.push(competitor);\n      }\n    }\n\n    settings.population = nextGeneration;\n  }\n\n  function randomizePopulationOrder() {\n    for (var index = 0; index < settings.population.length; index++) {\n      var otherIndex = Math.floor(Math.random() * settings.population.length);\n      var temp = settings.population[otherIndex];\n      settings.population[otherIndex] = settings.population[index];\n      settings.population[index] = temp;\n    }\n  }\n\n  return {\n    evolve: function (options) {\n      if (options) {\n        settings = settingWithDefaults(options, settings);\n      }\n\n      populate();\n      randomizePopulationOrder();\n      compete();\n      return this;\n    },\n    best: function () {\n      var scored = this.scoredPopulation();\n      var result = scored.reduce(function (a, b) {\n        return a.score >= b.score ? a : b;\n      }, scored[0]).phenotype;\n      return cloneJSON(result);\n    },\n    bestScore: function () {\n      return settings.fitnessFunction(this.best());\n    },\n    population: function () {\n      return cloneJSON(this.config().population);\n    },\n    scoredPopulation: function () {\n      return this.population().map(function (phenotype) {\n        return {\n          phenotype: cloneJSON(phenotype),\n          score: settings.fitnessFunction(phenotype),\n        };\n      });\n    },\n    config: function () {\n      return cloneJSON(settings);\n    },\n    clone: function (options) {\n      return geneticAlgorithmConstructor(\n        settingWithDefaults(options, settingWithDefaults(this.config(), settings))\n      );\n    },\n  };\n}\n","import GeneticAlgorithmConstructor, {\n  GeneticAlgorithmConfig,\n  ScoredPhenotype,\n} from '../geneticalgorithm/geneticalgorithm';\nimport {\n  handlePlayerEffect,\n  initialState,\n  makeGameNew,\n  playerActions,\n  previousState,\n  setSelected,\n} from './playGame';\nimport Chance from 'chance';\nimport {\n  Enemies,\n  EnemiesStats,\n  EnemyInfo,\n  Item,\n  MonsterTarget,\n  Play,\n  Player,\n  safeValues,\n  Seed,\n} from './types';\nimport { build } from './data';\nimport { Seq } from 'immutable';\nimport { playerStatsDefault } from './makeGame';\n\nexport type TinkererOptions = typeof defaultTinkererOptions;\n\nexport const defaultTinkererOptions = {\n  playerSeed: 'Miau',\n  weights: { monster: 1000, player: 0, turn: -0.1, stamina: 0 },\n  debug: false,\n};\n\ninterface StartStats {\n  startPlayerHealth: number;\n  startMonsterHealth: number;\n  startPlayerStamina: number;\n}\nconst scorePlay = (\n  options: TinkererOptions,\n  play: Play,\n  { startPlayerHealth, startMonsterHealth, startPlayerStamina }: StartStats\n) => {\n  const latestState = previousState(play);\n  const monsterHealth = latestState.enemies.reduce((acc, monster) => acc + monster.hp.current, 0);\n  const playerHealth = latestState.player.hp.current;\n  const playerStamina = latestState.player.stamina.current;\n\n  const monsterKillingFitness = Math.max(\n    0,\n    (startMonsterHealth - monsterHealth) / startMonsterHealth\n  );\n  const playerAlivenessFitness = playerHealth / startPlayerHealth;\n  const killSpeedFitness = (play.turns - play.states.length) / play.turns;\n  const staminaFitness = playerStamina / startPlayerStamina;\n\n  const fitness =\n    monsterKillingFitness * options.weights.monster +\n    playerAlivenessFitness * options.weights.player +\n    killSpeedFitness * options.weights.turn +\n    staminaFitness * options.weights.stamina;\n\n  if (options.debug || fitness < 0) {\n    console.log(\n      {\n        player: play.player.lore.name,\n        encounter: JSON.stringify(play.enemies.map((e) => e.lore.name)),\n        monsterHealth,\n        playerHealth,\n        turns: play.states.length,\n        fitness,\n        monsterKillingFitness,\n        playerAlivenessFitness,\n        staminaFitness,\n        killSpeedFitness,\n        weights: options.weights,\n      },\n      null,\n      2\n    );\n  }\n\n  return fitness;\n};\n\nconst startStats = (play: Play): StartStats => {\n  const startState = initialState(play);\n  const startPlayerHealth = startState.player.hp.max;\n  const startPlayerStamina = startState.player.stamina.max;\n  const startMonsterHealth = startState.enemies.reduce((acc, monster) => acc + monster.hp.max, 0);\n  return {\n    startPlayerHealth,\n    startMonsterHealth,\n    startPlayerStamina,\n  };\n};\n\nexport function findBestPlay(\n  play: Play,\n  iter: number,\n  population: number,\n  optionsOverride?: Partial<TinkererOptions>\n): ScoredPhenotype<Play>[] {\n  const options: TinkererOptions = {\n    ...defaultTinkererOptions,\n    ...optionsOverride,\n  };\n  const rand = new Chance(options.playerSeed);\n  const initStats = startStats(play);\n  const config: GeneticAlgorithmConfig<Play> = {\n    mutationFunction: (oldPlay) => {\n      const latestState = previousState(oldPlay);\n      const monsterHealth = latestState.enemies.reduce(\n        (acc, monster) => acc + monster.hp.current,\n        0\n      );\n      const playerHealth = latestState.player.hp.current;\n\n      // Won or loss, we bail\n      if (playerHealth === 0 || monsterHealth === 0 || oldPlay.states.length >= oldPlay.turns) {\n        return oldPlay;\n      }\n\n      // Maybe change monster\n      let newPlay = oldPlay;\n      while (rand.d6() === 6 || (latestState.enemies[latestState.target]?.hp.current ?? 0) <= 0) {\n        newPlay = setSelected(\n          newPlay,\n          rand.natural({\n            min: 0,\n            max: latestState.enemies.length - 1,\n          }) as MonsterTarget\n        );\n      }\n\n      // Use an action\n      const latest = previousState(newPlay);\n      const actions = playerActions(play.player, latest.inventory);\n      const unavailable = actions\n        .map((a, idx) => [a, idx] as const)\n        .filter(([a, _]) => a.stamina > latest.player.stamina.current)\n        .map(([_, idx]) => idx);\n      newPlay = handlePlayerEffect(\n        newPlay,\n        rand.natural({ min: 0, max: actions.length - 1, exclude: unavailable })\n      );\n\n      return newPlay;\n    },\n    fitnessFunction: (play) => scorePlay(options, play, initStats),\n    population: [play],\n    populationSize: population,\n  };\n\n  let gen = new GeneticAlgorithmConstructor<Play>(config);\n  for (let i = 0; i < iter; i++) {\n    gen = gen.evolve();\n  }\n\n  return Seq(gen.scoredPopulation())\n    .sortBy((a) => 1000 / a.score)\n    .toArray();\n}\n\nconst nonMutableProperties = new Set(['debug', 'basic']);\nexport const findBestBuild = (\n  players: Player[],\n  enemies: [Seed, EnemyInfo[]][],\n  iter: number,\n  gameIter: number,\n  population: number,\n  gamePopulation: number,\n  optionsOverride?: Partial<TinkererOptions & { turns: number }>\n): ScoredPhenotype<Player>[] => {\n  const options: TinkererOptions = {\n    ...defaultTinkererOptions,\n    ...optionsOverride,\n  };\n  const rng = new Chance(options.playerSeed);\n  const config: GeneticAlgorithmConfig<Player> = {\n    mutationFunction: (player: Player): Player => {\n      const toChange = rng.pickone(\n        Object.keys(player.build).filter((k) => !nonMutableProperties.has(k))\n      ) as keyof typeof build;\n      const newItem = rng.pickone(\n        safeValues<{ [k: string]: Item }, string>(build[toChange]).flatMap((a) =>\n          a.display !== player.build[toChange].display ? a : []\n        )\n      );\n      return {\n        ...player,\n        build: {\n          ...player.build,\n          [toChange]: newItem,\n        },\n      };\n    },\n    fitnessFunction: (player: Player) =>\n      Seq(enemies)\n        .flatMap((g) =>\n          Seq(\n            findBestPlay(\n              makeGameNew(\n                player,\n                playerStatsDefault,\n                g[1].map((a) => a[0]) as Enemies,\n                g[1].map((a) => a[1]) as EnemiesStats,\n                optionsOverride?.turns ?? 50,\n                g[0]\n              ),\n              gameIter,\n              gamePopulation,\n              optionsOverride\n            )\n          ).take(2)\n        )\n        .reduce((acc, v) => acc + v.score, 0),\n    population: players,\n    populationSize: population,\n  };\n\n  let gen = new GeneticAlgorithmConstructor<Player>(config);\n  for (let i = 0; i < iter; i++) {\n    gen = gen.evolve();\n  }\n\n  return Seq(gen.scoredPopulation())\n    .sortBy((a) => 1000 / a.score)\n    .toArray();\n};\n","import React from 'react';\nimport { Card, Button, OverlayTrigger, Popover } from 'react-bootstrap';\nimport { Enemy, Effect, EnemyStats } from '../game/types';\nimport { Seq } from 'immutable';\n\nconst skillPercents = (effects: Effect[]) =>\n  Seq(effects)\n    .countBy((e) => e.display)\n    .toArray()\n    .map(([display, v], idx) => {\n      const { range, priority, tooltip } = effects.find((a) => a.display === display)!!;\n      return (\n        <OverlayTrigger\n          key={idx}\n          placement=\"top\"\n          delay={{ show: 100, hide: 250 }}\n          overlay={(props) => (\n            <Popover {...props}>\n              <Popover.Header as=\"h3\">{display}</Popover.Header>\n              <Popover.Body>\n                {tooltip}\n                <br />\n                ⏱:{priority}\n                <br />\n                🏹:\n                {range.length === 5\n                  ? 'Any'\n                  : range.length === 0\n                  ? 'None'\n                  : range.map((a) => a + 1).join(', ')}\n              </Popover.Body>\n            </Popover>\n          )}\n        >\n          <>\n            <br />[{((v / effects.length) * 100).toFixed(2)}%] {display}\n          </>\n        </OverlayTrigger>\n      );\n    });\n\nconst EnemyCard: React.FC<{\n  enemy: Enemy;\n  enemyStats: EnemyStats;\n  latestAttack: string | undefined;\n  isSelected?: boolean;\n  onSelect: () => void;\n  canAct: boolean;\n  hotkey: string;\n}> = ({ enemy, enemyStats, isSelected, onSelect, latestAttack, canAct, hotkey }) => (\n  <Card bg={isSelected ? 'info' : undefined}>\n    {canAct && (\n      <Button disabled={isSelected} onClick={onSelect}>\n        [<i>{hotkey.toUpperCase()}</i>]\n      </Button>\n    )}\n    <Card.Body>\n      <Card.Title>\n        {enemy.lore.name} {enemyStats.hp.current > 0 ? '' : <b>💀DEAD💀</b>}\n      </Card.Title>\n      <Card.Text>\n        ❤:{enemyStats.hp.current} 🏹:{enemyStats.distance}\n        <br />A {enemyStats.attack.current} | D {enemyStats.defence.current} | S{' '}\n        {enemyStats.speed.current}\n        {enemyStats.status.bleed.turns > 0 && (\n          <>\n            <br />\n            {enemyStats.status.bleed.turns} 🩸\n          </>\n        )}\n        {latestAttack && (\n          <>\n            <br />\n            Latest attack: {latestAttack}\n          </>\n        )}\n        <br />\n        Next attack prediction:\n        {skillPercents(enemy.rolls[enemyStats.distance].map((idx) => enemy.effects[idx]))}\n      </Card.Text>\n    </Card.Body>\n  </Card>\n);\n\nexport default EnemyCard;\n","import React from 'react';\nimport {\n  Card,\n  Button,\n  ToggleButton,\n  ButtonGroup,\n  Popover,\n  OverlayTrigger,\n  Row,\n} from 'react-bootstrap';\nimport {\n  BuildRepository,\n  DisabledSkills,\n  InventoryEffect,\n  InventoryStats,\n  Item,\n  Player,\n  PlayerStats,\n  safeEntries,\n} from '../game/types';\nimport { Seq, Set } from 'immutable';\nimport { clamp } from '../game/zFunDump';\nimport { playerItemActions } from '../game/playGame';\n\nconst PlayerCard: React.FC<{\n  selectedButtons: Set<string>;\n  player: Player;\n  playerStats: PlayerStats;\n  inventoryStats: InventoryStats;\n  canAct: boolean;\n  lastAction: string | undefined;\n  onClickEffect: (index: number) => void;\n  disabledSkills: DisabledSkills;\n  hotkeys: string[];\n  setDisabledSkills: (skills: DisabledSkills) => void;\n}> = ({\n  selectedButtons,\n  player,\n  playerStats,\n  inventoryStats,\n  onClickEffect,\n  canAct,\n  lastAction,\n  disabledSkills,\n  setDisabledSkills,\n  hotkeys,\n}) => {\n  const passives = safeEntries(player.build).map(\n    ([k, e]) =>\n      [k, e, [...(e.bot ?? []), ...(e.eot ?? [])]] as [\n        keyof BuildRepository,\n        Item,\n        InventoryEffect[]\n      ]\n  );\n\n  const disabled = Set(disabledSkills);\n\n  const [passiveCount, passiveStamina] = passives.reduce(\n    ([count, sta], [k, _e, p]) => [\n      count + p.length,\n      sta + (disabled.has(k) ? 0 : p.reduce((acc, s) => acc + s.stamina, 0)),\n    ],\n    [0, 0]\n  );\n  const hasPassives = passiveCount > 0;\n  const staminaPerTurn = playerStats.staminaPerTurn.current - passiveStamina;\n\n  return (\n    <Card>\n      <Card.Body>\n        <Card.Title>\n          {player.lore.name}\n          {playerStats.hp.current > 0 ? '' : <b> 💀DEAD💀 </b>}\n        </Card.Title>\n        <Card.Subtitle className=\"mb-2 text-muted\">{player.build.class.display}</Card.Subtitle>\n        <Card.Text>\n          Attack {playerStats.attack.current} | Defence {playerStats.defence.current} | Speed{' '}\n          {playerStats.speed.current}\n        </Card.Text>\n        <Card.Text>{playerStats.hp.current} ❤</Card.Text>\n        <Card.Text>\n          {playerStats.stamina.current}/{playerStats.stamina.max} 💪 ({staminaPerTurn >= 0 && '+'}\n          {staminaPerTurn})\n        </Card.Text>\n        {playerStats.status.bleed.turns > 0 && (\n          <Card.Text>{playerStats.status.bleed.turns} 🩸</Card.Text>\n        )}\n        {lastAction && <Card.Text>Last action: {lastAction}</Card.Text>}\n        {canAct && hasPassives && (\n          <Row>\n            <b>Passives</b>\n            <ButtonGroup>\n              {passives.map(\n                ([k, _i, effs]) =>\n                  effs.length > 0 &&\n                  effs.map((e, idx) => (\n                    <OverlayTrigger\n                      key={idx}\n                      placement=\"top\"\n                      delay={{ show: 100, hide: 250 }}\n                      overlay={(props) => (\n                        <Popover {...props}>\n                          <Popover.Header as=\"h3\">{e.display}</Popover.Header>\n                          <Popover.Body>{e.tooltip}</Popover.Body>\n                        </Popover>\n                      )}\n                    >\n                      <ToggleButton\n                        checked={!disabled.has(k)}\n                        value={k}\n                        id={`passive-skill-${k}`}\n                        type=\"checkbox\"\n                        variant=\"outline-primary\"\n                        onChange={(event) =>\n                          setDisabledSkills(\n                            event.currentTarget.checked\n                              ? Set(disabledSkills).delete(k).toArray()\n                              : Set(disabledSkills).add(k).toArray()\n                          )\n                        }\n                      >\n                        {e.display} (💪: {e.stamina})\n                      </ToggleButton>\n                    </OverlayTrigger>\n                  ))\n              )}\n            </ButtonGroup>\n          </Row>\n        )}\n        {canAct &&\n          Seq(playerItemActions(player, inventoryStats))\n            .map((a, idx) => [idx, a] as const)\n            .groupBy(([idx, [i, _e]]) => i.display)\n            .toArray()\n            .map(([k, effects]) => (\n              <Row key={k}>\n                <b>{k}</b>\n                <ButtonGroup>\n                  {effects\n                    .map(([idx, [_i, e]]) => (\n                      <OverlayTrigger\n                        key={e.display}\n                        placement=\"top\"\n                        delay={{ show: 100, hide: 250 }}\n                        overlay={(props) => (\n                          <Popover {...props}>\n                            <Popover.Header as=\"h3\">{e.display}</Popover.Header>\n                            <Popover.Body>{e.tooltip}</Popover.Body>\n                          </Popover>\n                        )}\n                      >\n                        <Button\n                          active={selectedButtons.has(e.display)}\n                          disabled={playerStats.stamina.current < e.stamina}\n                          onClick={(_) => onClickEffect(idx)}\n                        >\n                          [<i>{hotkeys[idx]}</i>] <b>{e.display}</b>\n                          <Card.Text>\n                            💪:{e.stamina} ⏱:\n                            {clamp(e.priority - playerStats.speed.current, 0, 4)}\n                            <br />\n                            🏹:\n                            {e.range.length === 5 ? 'All' : e.range.join(', ')}\n                          </Card.Text>\n                        </Button>\n                      </OverlayTrigger>\n                    ))\n                    .toArray()}\n                </ButtonGroup>\n              </Row>\n            ))}\n      </Card.Body>\n    </Card>\n  );\n};\n\nexport default PlayerCard;\n","import { Container, Row, Col, Card, Modal, ButtonGroup, CardGroup } from 'react-bootstrap';\nimport { DisabledSkills, MonsterTarget, Play } from '../game/types';\nimport EnemyCard from './Enemy';\nimport PlayerCard from './Player';\nimport usePressedKeys from '../hooks/usePressedKeys';\nimport { playerActions, PlayState, playState } from '../game/playGame';\nimport { Seq, Set } from 'immutable';\nimport { previousState } from '../game/playGame';\nimport { Button } from 'react-bootstrap';\nimport saveAs from 'file-saver';\nimport { useCallback, useEffect, useState } from 'react';\nimport { updateGlobals } from '../game/modding';\nimport { useForceRerender } from '../hooks/useForceRerender';\n\nexport type GameProps = {\n  game: Play;\n  setSelected: (target: MonsterTarget) => void;\n  setDisabledSkills: (disabled: DisabledSkills) => void;\n  handlePlayerEffect: (index: number) => void;\n  solveGame: (iterations: number, population: number) => void;\n  hint: (iterations: number, population: number) => void;\n  timeTravel: { undo: () => void; redo: (() => void) | undefined } | undefined;\n  onMenu: () => void;\n  onGameEnd: (state: PlayState, play: Play) => void;\n};\n\nconst playerHotkeys = [\n  'q',\n  'w',\n  'e',\n  'r',\n  't',\n  'y',\n  'u',\n  'i',\n  'o',\n  'p',\n  'z',\n  'x',\n  'c',\n  'v',\n  'b',\n  'n',\n  'm',\n];\n\nconst Game = ({\n  handlePlayerEffect,\n  setSelected,\n  setDisabledSkills,\n  game,\n  solveGame,\n  timeTravel,\n  hint,\n  onMenu,\n  onGameEnd,\n}: GameProps): JSX.Element => {\n  const { player, enemies } = game;\n  const {\n    player: playerStats,\n    enemies: enemiesStats,\n    target,\n    lastAttacks,\n    disabledSkills,\n    inventory: inventoryStats,\n  } = previousState(game);\n  const [isLogShown, setShowLog] = useState(false);\n  const forceUpdate = useForceRerender();\n\n  useEffect(() => {\n    updateGlobals({ ingame: { game, forceUpdate } });\n    return () => updateGlobals({ ingame: undefined });\n  }, [game, forceUpdate]);\n\n  const playerSkills = playerActions(player, inventoryStats);\n  const gameState = playState(game);\n\n  const handleCloseLog = () => setShowLog(false);\n  const handleShowLog = () => setShowLog(true);\n\n  const pressed = usePressedKeys((key) => {\n    if (key === 'Escape') {\n      onMenu();\n    }\n    if (key === 'h') {\n      hint(5, 100);\n    }\n\n    if (key === 'l') {\n      setShowLog(!isLogShown);\n    }\n\n    if (key === 's') {\n      save();\n    }\n\n    if (key === 'a' && game.states.length > 1 && timeTravel) {\n      timeTravel.undo();\n    }\n    if (key === 'd' && timeTravel && timeTravel.redo != null) {\n      timeTravel.redo();\n    }\n\n    if (gameState !== 'playing') return;\n\n    const skillIndex = playerHotkeys.indexOf(key);\n    if (skillIndex !== -1) {\n      const skillNumber = playerHotkeys.indexOf(key);\n      const hasStamina = playerSkills[skillNumber].stamina <= playerStats.stamina.current;\n      if (!hasStamina) return;\n      handlePlayerEffect(skillNumber);\n    }\n\n    const valNum = parseInt(key);\n    if (valNum > 0 && valNum <= enemies.length) {\n      setSelected((valNum - 1) as MonsterTarget);\n    }\n  });\n\n  const selectedButtons = Set<string>(\n    [...pressed].flatMap((key: string) => {\n      const skillIndex = playerHotkeys.indexOf(key);\n      if (skillIndex !== -1) {\n        return [playerSkills[skillIndex].display];\n      } else {\n        return [];\n      }\n    })\n  );\n\n  const save = useCallback(() => {\n    const blob = new Blob([JSON.stringify(game)], {\n      type: 'application/json;charset=utf-8',\n    });\n    saveAs(blob, `buildmancer-${Date.now()}.bmreplay`);\n  }, [game]);\n\n  return (\n    <>\n      <Container fluid>\n        <Row>\n          <Col className=\"d-flex justify-content-between align-items-center\">\n            <Card.Title>\n              Turn {game.states.length} out of {game.turns}\n            </Card.Title>\n            {gameState !== 'playing' && (\n              <Button onClick={() => onGameEnd(gameState, game)}>\n                {gameState === 'loss'\n                  ? '💀💀DEFEAT💀💀'\n                  : gameState === 'win'\n                  ? '🎉🎉VICTORY🎉🎉'\n                  : 'THIS IS A BUG, PLEASE REPORT IT'}\n              </Button>\n            )}\n            <Button onClick={onMenu}>\n              [<i>Esc</i>] MAIN MENU\n            </Button>\n          </Col>\n          <CardGroup>\n            {Seq(enemies)\n              .zip(Seq(enemiesStats))\n              .map(([enemy, stats], idx) => (\n                <EnemyCard\n                  key={idx}\n                  enemyStats={stats}\n                  enemy={enemy}\n                  canAct={gameState === 'playing'}\n                  latestAttack={\n                    Seq(lastAttacks)\n                      .filter(({ origin, phase }) => origin === idx && phase === 'MAIN')\n                      .map((a) => `${a.display}`)\n                      .join(' -> ') ?? undefined\n                  }\n                  isSelected={idx === target}\n                  onSelect={() => setSelected(idx as MonsterTarget)}\n                  hotkey={`${idx + 1}`}\n                />\n              ))}\n          </CardGroup>\n          <Col>\n            <PlayerCard\n              player={player}\n              playerStats={playerStats}\n              inventoryStats={inventoryStats}\n              disabledSkills={disabledSkills}\n              setDisabledSkills={setDisabledSkills}\n              onClickEffect={(idx) => handlePlayerEffect(idx)}\n              selectedButtons={selectedButtons}\n              hotkeys={playerHotkeys}\n              lastAction={\n                lastAttacks\n                  .filter((a) => a.origin === 'Player' && a.phase !== 'CLEANUP')\n                  .map((a) => `${a.display}`)\n                  .join(' -> ') ?? undefined\n              }\n              canAct={gameState === 'playing'}\n            />\n          </Col>\n          <Card>\n            <Card.Body>\n              <Card.Title>Turns</Card.Title>\n              <Row>\n                <ButtonGroup>\n                  <Button onClick={(_) => hint(5, 100)}>\n                    <i>[H]</i> Hint\n                  </Button>\n                </ButtonGroup>\n                {timeTravel != null && (\n                  <ButtonGroup>\n                    {game.states.length > 1 && (\n                      <Button onClick={(_) => timeTravel.undo()}>\n                        [<i>A</i>] Undo ↩\n                      </Button>\n                    )}\n                    {timeTravel.redo && (\n                      <Button onClick={(_) => timeTravel.redo!!()}>\n                        [<i>D</i>] Redo ↪\n                      </Button>\n                    )}\n                  </ButtonGroup>\n                )}\n              </Row>\n              <Card.Title>Debug</Card.Title>\n              <Row>\n                <ButtonGroup>\n                  <Button onClick={handleShowLog}>\n                    [<i>L</i>] Log 🗒\n                  </Button>\n                  <Button onClick={save}>\n                    [<i>S</i>] Save Replay 📂\n                  </Button>\n                </ButtonGroup>\n              </Row>\n              <Card.Title>Cheats</Card.Title>\n              <Row>\n                <ButtonGroup>\n                  <Button onClick={(_) => solveGame(5, 100)}>Solve ⌛</Button>\n                  <Button onClick={(_) => solveGame(20, 100)}>Solve thoroughly ⌛⌛⌛</Button>\n                </ButtonGroup>\n              </Row>\n            </Card.Body>\n          </Card>\n        </Row>\n      </Container>\n      <Modal show={isLogShown} onHide={handleCloseLog} scrollable={true} centered={true}>\n        <Modal.Header closeButton>\n          <Modal.Title>Game Log</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          {game.states.map((s, idx) => (\n            <div key={idx}>\n              <b>Turn {idx}</b>\n              <br />\n              Player: {JSON.stringify(s.player, null, 2)}\n              <br />\n              Enemies: {JSON.stringify(s.enemies, null, 2)}\n              <br />\n              Inventory?: {JSON.stringify(s.inventory, null, 2)}\n              <br />\n              Target [{s.target}]<br />\n              Bot?: {JSON.stringify(s.bot, null, 2)}\n              <br />\n              Eot?: {JSON.stringify(s.eot, null, 2)}\n              <br />\n              Actions:\n              <br />\n              {s.lastAttacks.map((a, idx) => (\n                <div key={idx}>\n                  {'-->'} {JSON.stringify(a, null, 2)}\n                  <br />\n                </div>\n              ))}\n            </div>\n          ))}\n        </Modal.Body>\n        <Modal.Footer>\n          <Button variant=\"primary\" onClick={handleCloseLog}>\n            Close\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    </>\n  );\n};\n\nexport default Game;\n","import React from 'react';\n\nexport function useForceRerender() {\n  const [value, setValue] = React.useState(false);\n  return () => setValue(!value);\n}\n","import { useEffect, useCallback, useState } from 'react';\n\nexport default function usePressedKeys(onUp: (e: string) => void): Set<string> {\n  const [pressedKeys, updatePressedKeys] = useState(new Set<string>());\n\n  const downHandler = ({ key }: { key: string }) => {\n    updatePressedKeys((set) => new Set([...set, key]));\n  };\n\n  const upHandler = useCallback(\n    ({ key }: { key: string }) => {\n      updatePressedKeys((set) => new Set([...set].filter((k) => k !== key)));\n      onUp(key);\n    },\n    [onUp]\n  );\n\n  useEffect(() => {\n    window.addEventListener('keydown', downHandler);\n    window.addEventListener('keyup', upHandler);\n\n    return () => {\n      window.removeEventListener('keydown', downHandler);\n      window.removeEventListener('keyup', upHandler);\n    };\n  }, [upHandler]);\n\n  return pressedKeys;\n}\n","import { Seq } from 'immutable';\nimport React from 'react';\nimport { findBestPlay } from '../game/tinkerer';\nimport { initialState, previousState } from '../game/playGame';\nimport { PlayState, setSelected, setDisabledSkills, handlePlayerEffect } from '../game/playGame';\nimport { Play, Snapshot } from '../game/types';\nimport Game from './Game';\n\nconst SingleGame = ({\n  play,\n  timeTravel,\n  onGameEnd,\n  onMenu,\n}: {\n  play: Play;\n  timeTravel: boolean;\n  onGameEnd: (state: PlayState, play: Play) => void;\n  onMenu: () => void;\n}) => {\n  const [game, setGame] = React.useState<Play>(play);\n  const [redo, setRedo] = React.useState<Snapshot[]>([]);\n\n  React.useEffect(() => {\n    setGame(play);\n  }, [play]);\n\n  const timeTravelObj = timeTravel\n    ? {\n        redo:\n          redo.length > 0\n            ? () => {\n                const newRedo = [...redo];\n                const latest = newRedo.pop() as Snapshot;\n                setRedo(newRedo);\n                setGame({ ...game, states: [...game.states, latest] });\n              }\n            : undefined,\n        undo: () => {\n          setRedo([...redo, previousState(game)]);\n          setGame({\n            ...game,\n            states: [initialState(game), ...game.states.slice(1, -1)],\n          });\n        },\n      }\n    : undefined;\n\n  return (\n    <Game\n      game={game}\n      timeTravel={timeTravelObj}\n      onMenu={onMenu}\n      onGameEnd={onGameEnd}\n      setSelected={(idx) => {\n        setRedo([]);\n        setGame(setSelected(game, idx));\n      }}\n      setDisabledSkills={(disabled) => {\n        setRedo([]);\n        setGame(setDisabledSkills(game, disabled));\n      }}\n      handlePlayerEffect={(idx) => {\n        setRedo([]);\n        setGame(handlePlayerEffect(game, idx));\n      }}\n      solveGame={(iterations, population) =>\n        setGame(Seq(findBestPlay(game, iterations, population)).maxBy((a) => a.score)!!.phenotype)\n      }\n      hint={(iterations, population) =>\n        setGame({\n          ...game,\n          states: [\n            ...game.states,\n            Seq(findBestPlay(game, iterations, population)).maxBy((a) => a.score)!!.phenotype\n              .states[game.states.length],\n          ],\n        })\n      }\n    />\n  );\n};\n\nexport default SingleGame;\n","import React from 'react';\nimport { Form, Col, Row, Alert, Button, Container } from 'react-bootstrap';\nimport { Play } from '../../game/types';\nimport { playSchema } from '../../game/typesSchemas';\n\nconst LoadScreen = ({ onLoad, onMenu }: { onLoad: (g: Play) => void; onMenu: () => void }) => {\n  const [loadError, setLoadError] = React.useState<string | undefined>();\n  const load = (data: string) => {\n    try {\n      const playRaw = JSON.parse(data);\n      try {\n        // FIXME update schema\n        //playSchema.parse(playRaw);\n        onLoad(playRaw as Play);\n      } catch (e) {\n        setLoadError('Failed to load Replay - Invalid Data');\n      }\n    } catch (e) {\n      setLoadError('Failed to load Replay - Bad Data');\n    }\n  };\n  const onFormSubmit = (e: any) => {\n    e.preventDefault();\n    if (e.target?.fileData?.files[0] != null) {\n      const reader = new FileReader();\n      reader.onloadend = (ev: ProgressEvent<FileReader>) => {\n        const result = ev.target?.result as string | undefined;\n        if (result != null) {\n          load(result);\n        } else {\n          setLoadError('Failed to load Replay - Bad File');\n        }\n      };\n      reader.readAsText(e.target.fileData.files[0]);\n    } else if (e.target?.rawData?.value != null && e.target?.rawData?.value !== '') {\n      load(e.target.rawData.value);\n    }\n  };\n  return (\n    <Form onSubmit={onFormSubmit}>\n      <Container fluid>\n        <Col>\n          <Row>\n            {loadError && (\n              <>\n                <Alert variant={'danger'}>{loadError}</Alert>\n                <br />\n                <br />\n              </>\n            )}\n          </Row>\n          <Row>\n            <Form.Group>\n              <Form.Label>Load Replay from File</Form.Label>\n              <Form.Control type=\"file\" name=\"fileData\" accept=\".bmreplay\" />\n              <Form.Text muted>Select the Replay file to load</Form.Text>\n            </Form.Group>\n          </Row>\n          <br />\n          <Row>\n            <Form.Group>\n              <Form.Label>Load Replay from Text</Form.Label>\n              <Form.Control name=\"rawData\" as=\"textarea\" rows={3} placeholder=\"Replay text\" />\n              <Form.Text muted>Paste the text of your Replay here</Form.Text>\n            </Form.Group>\n          </Row>\n          <br />\n          <Button variant=\"primary\" type=\"submit\">\n            Load\n          </Button>\n        </Col>\n        <br />\n        <Button onClick={onMenu}>MAIN MENU</Button>\n      </Container>\n    </Form>\n  );\n};\n\nexport default LoadScreen;\n","import './App.css';\n// import { readString } from \"react-papaparse\";\nimport { Snapshot, Play, EnemyStats, Enemy, EnemiesStats, Enemies } from './game/types';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport PlayerBuilder from './components/PlayerBuilder';\nimport EncounterBuilder from './components/EncounterBuilder';\nimport {\n  initialState,\n  makeGameNew,\n  makeGameNextLevel,\n  PlayState,\n  previousState,\n} from './game/playGame';\nimport { dummyEnemy, randomEnemy, randomPlayer } from './game/makeGame';\nimport { useMachine } from '@xstate/react';\nimport { gameMenuMachine } from './stateMachines/menuStateMachine';\nimport Menu from './components/menus/Menu';\nimport SingleGame from './components/SingleGame';\nimport LoadScreen from './components/menus/LoadScreen';\n\nfunction App() {\n  const [state, send] = useMachine(gameMenuMachine, { devTools: true });\n  const event = state.event;\n  const onMenu = () => {\n    send('MENU');\n  };\n\n  switch (true) {\n    case state.matches('main'):\n      return (\n        <Menu\n          title={'Main Menu'}\n          states={Object.keys(gameMenuMachine.states.main.on)}\n          onClick={send}\n        />\n      );\n    // QUICK\n    case state.matches({ quick: 'play' }): {\n      const player = randomPlayer();\n      const encounter = randomEnemy();\n      return (\n        <SingleGame\n          play={makeGameNew(\n            player[0],\n            player[1],\n            [encounter[0]],\n            [encounter[1]],\n            50,\n            state.context.singleContext.seed\n          )}\n          onMenu={onMenu}\n          timeTravel={true}\n          onGameEnd={(result, game) => {\n            send(result === 'win' ? 'WIN' : 'LOSE', { result, game });\n          }}\n        />\n      );\n    }\n    case state.matches({ quick: 'win' }):\n    case state.matches({ quick: 'lose' }):\n      return (\n        <Menu\n          title={`${event.result} in ${event.game.states.length - 1} turns`}\n          states={['MENU']}\n          onClick={send}\n        />\n      );\n    // SINGLE\n    case state.matches({ single: 'player' }):\n      return (\n        <PlayerBuilder\n          onSave={(player, playerStats) => {\n            send('PLAYER', { player: [player, playerStats] });\n          }}\n        />\n      );\n    case state.matches({ single: 'encounter' }):\n      return (\n        <EncounterBuilder\n          player={event.player}\n          onSave={(enemies, enemiesStats) => {\n            send('ENCOUNTER', {\n              encounter: [enemies, enemiesStats],\n              player: event.player,\n            });\n          }}\n        />\n      );\n    case state.matches({ single: 'play' }): {\n      return (\n        <SingleGame\n          play={makeGameNew(\n            event.player[0],\n            event.player[1],\n            event.encounter[0],\n            event.encounter[1],\n            50,\n            state.context.singleContext.seed\n          )}\n          onMenu={onMenu}\n          timeTravel={true}\n          onGameEnd={(result, game) => {\n            send(result === 'win' ? 'WIN' : 'LOSE', { result, game });\n          }}\n        />\n      );\n    }\n    case state.matches({ single: 'win' }):\n    case state.matches({ single: 'lose' }):\n      return (\n        <Menu\n          title={`${event.result} in ${event.game.states.length - 1} turns`}\n          states={['MENU']}\n          onClick={send}\n        />\n      );\n    // TRAINING\n    case state.matches({ training: 'player' }):\n      return (\n        <PlayerBuilder\n          onSave={(player, playerStats) => {\n            send('PLAYER', { player: [player, playerStats] });\n          }}\n        />\n      );\n    case state.matches({ training: 'play' }): {\n      const player = randomPlayer();\n      const encounter = dummyEnemy();\n      return (\n        <SingleGame\n          play={makeGameNew(\n            player[0],\n            player[1],\n            [encounter[0]],\n            [encounter[1]],\n            50,\n            state.context.singleContext.seed\n          )}\n          onMenu={onMenu}\n          timeTravel={true}\n          onGameEnd={(result, game) => {\n            send(result === 'win' ? 'WIN' : 'LOSE', { result, game });\n          }}\n        />\n      );\n    }\n    case state.matches({ training: 'win' }):\n    case state.matches({ training: 'lose' }):\n      return (\n        <Menu\n          title={`You have dealt a lot of damage! Well done 💯`}\n          states={['MENU']}\n          onClick={send}\n        />\n      );\n    // ARCADE\n    case state.matches({ arcade: 'player' }): {\n      const encounter = randomEnemy();\n      return (\n        <PlayerBuilder\n          onSave={(player, playerStats) => {\n            send('PLAYER', {\n              game: makeGameNew(\n                player,\n                playerStats,\n                [encounter[0]],\n                [encounter[1]],\n                50,\n                state.context.survivalContext.seed\n              ),\n            });\n          }}\n        />\n      );\n    }\n    case state.matches({ arcade: 'play' }): {\n      return (\n        <SingleGame\n          play={event.game}\n          timeTravel={false}\n          onMenu={onMenu}\n          onGameEnd={(result: PlayState, game: Play) => {\n            let encounter = [[], []] as [Enemy[], EnemyStats[]];\n            if (state.context.arcadeContext.victories >= 0) {\n              const otherEnemy = randomEnemy();\n              encounter = [\n                [...encounter[0], otherEnemy[0]],\n                [...encounter[1], otherEnemy[1]],\n              ];\n            }\n            if (state.context.arcadeContext.victories >= 2) {\n              const otherEnemy = randomEnemy();\n              encounter = [\n                [...encounter[0], otherEnemy[0]],\n                [...encounter[1], otherEnemy[1]],\n              ];\n            }\n            if (state.context.arcadeContext.victories >= 5) {\n              const otherEnemy = randomEnemy();\n              encounter = [\n                [...encounter[0], otherEnemy[0]],\n                [...encounter[1], otherEnemy[1]],\n              ];\n            }\n            const firstState: Snapshot = initialState(game);\n            send(result === 'win' ? 'WIN' : 'LOSE', {\n              result,\n              game: makeGameNextLevel(\n                game.player,\n                firstState.player,\n                encounter[0] as Enemies,\n                encounter[1] as EnemiesStats,\n                {},\n                50,\n                state.context.survivalContext.seed\n              ),\n            });\n          }}\n        />\n      );\n    }\n    case state.matches({ arcade: 'victory' }): {\n      return (\n        <Menu\n          title={`🎉🎉VICTORY!🎉🎉 Final score: ${state.context.arcadeContext.score}`}\n          states={['MENU']}\n          onClick={send}\n        />\n      );\n    }\n    case state.matches({ arcade: 'defeat' }): {\n      return (\n        <Menu\n          title={`Failed after ${state.context.arcadeContext.victories} victories`}\n          states={['MENU']}\n          onClick={send}\n        />\n      );\n    }\n    // SURVIVAL\n    case state.matches({ survival: 'player' }): {\n      const encounter = randomEnemy();\n      return (\n        <PlayerBuilder\n          onSave={(player, playerStats) => {\n            send('PLAYER', {\n              game: makeGameNew(\n                player,\n                playerStats,\n                [encounter[0]],\n                [encounter[1]],\n                50,\n                state.context.survivalContext.seed\n              ),\n            });\n          }}\n        />\n      );\n    }\n    case state.matches({ survival: 'play' }): {\n      return (\n        <SingleGame\n          play={event.game}\n          onMenu={onMenu}\n          timeTravel={false}\n          onGameEnd={(result, game) => {\n            const encounter = randomEnemy();\n            const lastState: Snapshot = previousState(game);\n            send(result === 'win' ? 'WIN' : 'LOSE', {\n              result,\n              game: makeGameNextLevel(\n                game.player,\n                lastState.player,\n                [encounter[0]],\n                [encounter[1]],\n                lastState.inventory,\n                50,\n                state.context.survivalContext.seed\n              ),\n            });\n          }}\n        />\n      );\n    }\n    case state.matches({ survival: 'defeat' }): {\n      return (\n        <Menu\n          title={`Completed after ${state.context.survivalContext.victories} victories`}\n          states={['MENU']}\n          onClick={send}\n        />\n      );\n    }\n    // LOAD\n    case state.matches({ replay: 'replay' }): {\n      return <LoadScreen onLoad={(game) => send('REPLAY', { game })} onMenu={onMenu} />;\n    }\n    case state.matches({ replay: 'play' }): {\n      return (\n        <SingleGame\n          play={event.game}\n          onMenu={onMenu}\n          timeTravel={true}\n          onGameEnd={(result, game) => {\n            send(result === 'win' ? 'WIN' : 'LOSE', { result, game });\n          }}\n        />\n      );\n    }\n    case state.matches({ replay: 'win' }):\n    case state.matches({ replay: 'lose' }):\n      return (\n        <Menu\n          title={`${event.result} in ${event.game.states.length - 1} turns`}\n          states={['MENU']}\n          onClick={send}\n        />\n      );\n    default:\n      return <>{JSON.stringify(state.value)}</>;\n  }\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport { Card, Row, Col, Button, Modal, ButtonGroup } from 'react-bootstrap';\n\nconst contestThread =\n  'https://boardgamegeek.com/thread/2875719/2022-solitaire-print-and-play-contest';\nconst gameThread =\n  'https://boardgamegeek.com/thread/2858500/wip-buildmancer-pre-release-tinkering-player-build';\n\nconst GameInfoBar = () => {\n  const [areRulesShown, showRules] = React.useState(false);\n  return (\n    <>\n      <Card>\n        <Card.Body>\n          <Row className=\"d-flex justify-content-between align-items-center\">\n            <Col xs={8}>\n              <Card.Text>\n                Buildmancer by pakoito (2022) for the{' '}\n                <a href={contestThread}>BGG's 2022 Solitaire Print and Play Contest</a>. Send your\n                feedback and Replays to the <a href={gameThread}>game entry thread</a>!\n              </Card.Text>\n            </Col>\n            <Col>\n              <ButtonGroup size=\"lg\">\n                <Button onClick={() => showRules(true)}>Rules</Button>\n                <Button variant=\"secondary\" active={false}>\n                  {'Print & Play'}\n                </Button>\n              </ButtonGroup>\n            </Col>\n          </Row>\n        </Card.Body>\n      </Card>\n      <Modal\n        fullscreen={true}\n        show={areRulesShown}\n        onHide={() => showRules(false)}\n        scrollable={true}\n        centered={true}\n      >\n        <Modal.Header closeButton>\n          <Modal.Title>Game Log</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          Buildmancer has your standard turn-based JRPG rules. If you're familiar with Pokemon,\n          Final Fantasy or Dragon Quest you will be right at home.\n          <br />\n          <br />\n          As a player, you win 🎉 if you reduce your Enemy's health ❤ to 0.\n          <br />\n          You lose 💀 if your health ❤ becomes 0.\n          <br />\n          <br />\n          Each turn you select one Skill to use, from the ones given by your Background and\n          Equipment.\n          <br />\n          Enemies will choose one of their Skills with a fair roll of a dice.\n          <br />\n          Some Skills are Passive, which means they will be active on top of your chosen Skill.\n          <br />\n          <br />\n          Skills can do an amount of damage that is increased or reduced by the Attack and Defense\n          stats.\n          <br />\n          Skills cost stamina 💪 to use. You have a maximum amount of total stamina, and an amount\n          that is restored per turn. Passive skills consume additional stamina.\n          <br />\n          Skills also have initiative ⏱, and the lowest between your skill and your enemy's\n          determines which one will be resolved first. It is modified by your Speed stat.\n          <br />\n          Skills have a determined range 🏹, and whiff if the targeted enemy is outside of it at the\n          moment of the attack. Use movement Skills to get in and out of danger!\n          <br />\n          <br />\n          Skills can apply status effects to you or the enemy:\n          <br />\n          &emsp;<i>Shield</i>: absorbs up to X damage this turn\n          <br />\n          &emsp;<i>Bleed</i>: increases any instances of damage by 1 for several turns\n          <br />\n          &emsp;<i>Poison</i>: deals 1 damage at the end of the turn for several turns\n          <br />\n          &emsp;<i>Dodge</i>: avoids the next attack this turn Stun: skips all the current turn\n          actions\n          <br />\n          <br />\n          Experiment with different Backgrounds and Equipments to get additional stats, and beat the\n          different play modes!\n        </Modal.Body>\n        <Modal.Footer>\n          <Button variant=\"primary\" onClick={() => showRules(false)}>\n            Close\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    </>\n  );\n};\n\nexport default GameInfoBar;\n","import React from 'react';\nimport { createRoot } from 'react-dom/client';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration';\nimport reportWebVitals from './reportWebVitals';\nimport { Container, Row } from 'react-bootstrap';\nimport GameInfoBar from './components/GameInfoBar';\n\nconst container = document.getElementById('root');\nconst root = createRoot(container!);\nroot.render(\n  <React.StrictMode>\n    <Container fluid>\n      <Row>\n        <App />\n      </Row>\n      <GameInfoBar />\n    </Container>\n  </React.StrictMode>\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://cra.link/PWA\nserviceWorkerRegistration.register();\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import { Opaque } from 'type-fest';\nimport { enemies } from './data';\nimport { EnemiesIndex } from './data/enemies';\nimport { allRanges, makeStat } from './makeGame';\nimport { updateGlobals } from './modding';\nimport {\n  callEffectFun,\n  Effect,\n  effectFunCall,\n  EffectTarget,\n  Enemies,\n  EnemiesStats,\n  Enemy,\n  EnemyStats,\n  FunIndex,\n  MonsterTarget,\n  Play,\n  PlayerStats,\n  Snapshot,\n  StatEffectTarget,\n  Status,\n  Target,\n} from './types';\nimport { clamp, pipe } from './zFunDump';\n\n// #region Effect funs\n\nexport function extractFunction({ effects }: Effect): ReduceFun {\n  return (origin, play, startState) =>\n    effects.reduce(\n      (acc, { index, parameters }) =>\n        callEffectFun(effectFunRepo, index, parameters)(origin, ...acc),\n      [play, startState]\n    );\n}\n\nconst effectFun = <T>(fun: ParametrizedFun<T>): EffectFun<T> =>\n  ((params) => (origin, play, oldState) => fun(params)(origin, play, oldState)) as EffectFun<T>;\n\ntype SystemFunctionT = {\n  'Utility:Cleanup': undefined;\n  'Debug:GGWP': undefined;\n  'Debug:Sudoku': undefined;\n};\ntype BasicFunctionT = {\n  'Basic:Rest': undefined;\n  'Basic:Move': { amount: number };\n  'Basic:Attack': { amount: number };\n  'Basic:Stamina': { amount: number };\n  'Basic:HP': { amount: number };\n};\n\ntype StatusFunctionT = {\n  'Effect:Poison': { target: EffectTarget; turns: number };\n  'Effect:Dodge': undefined;\n  'Effect:Armor': { amount: number };\n  'Effect:Stun': undefined;\n  'Effect:Bleed': { target: EffectTarget; turns: number };\n  'Effect:Stat': StatEffectTarget;\n};\n\ntype MonsterFunctionT = {\n  'Monster:Summon': { enemy: EnemiesIndex };\n  'Monster:Dead': undefined;\n  'Monster:Attack': { amount: number };\n  'Monster:Move': { amount: number };\n};\ntype ItemFunctionT = {\n  'Wand:MagicBolt': undefined;\n  'BootsOfFlight:EOT': undefined;\n};\ntype ReduceFunctionT = {\n  'Reduce:PoisonBOT': { target: Target; turns: number };\n};\n\nconst engineFunctions = {\n  'Debug:GGWP': effectFun(() => (_, play, currentState) => [\n    play,\n    {\n      ...currentState,\n      enemies: currentState.enemies.map((m) => ({\n        ...m,\n        hp: { ...m.hp, current: 0 },\n      })) as EnemiesStats,\n    },\n  ]),\n  'Debug:Sudoku': effectFun(() => (_, play, currentState) => [\n    play,\n    {\n      ...currentState,\n      player: {\n        ...currentState.player,\n        hp: { ...currentState.player.hp, current: 0 },\n      },\n    },\n  ]),\n  'Utility:Cleanup': effectFun(() => (_origin, play, currentState) => [\n    play,\n    pipe(\n      actions.changeStatusPlayer(currentState, (o) => ({\n        ...o,\n        armor: { amount: 0 },\n        bleed: { turns: Math.max(o.bleed.turns - 1, 0) },\n        dodge: { active: false },\n        stun: { active: false },\n      })),\n      (newState) =>\n        newState.enemies.reduce(\n          (acc, v, idx) =>\n            actions.changeStatusMonster(acc, idx as MonsterTarget, (o) => ({\n              ...o,\n              armor: { amount: 0 },\n              bleed: { turns: Math.max(o.bleed.turns - 1, 0) },\n              dodge: { active: false },\n              stun: { active: false },\n            })),\n          currentState\n        )\n    ),\n  ]),\n};\n\nconst effectFunRepo: EffectFunctionRepository = {\n  ...engineFunctions,\n  // #region BASIC\n  'Basic:Rest': effectFun(() => (_origin, play, currentState) => [play, currentState]),\n  'Basic:Move': effectFun(({ amount }) => (_origin, play, currentState) => [\n    play,\n    actions.changeDistance(currentState, currentState.target, amount),\n  ]),\n  'Basic:Attack': effectFun(({ amount }) => (_origin, play, currentState) => [\n    play,\n    actions.attackMonster(currentState, currentState.target, amount),\n  ]),\n  'Basic:Stamina': effectFun(({ amount }) => (_origin, play, currentState) => [\n    play,\n    actions.modifyPlayerStamina(currentState, amount),\n  ]),\n  'Basic:HP': effectFun(({ amount }) => (_origin, play, currentState) => [\n    play,\n    actions.changeStatPlayer(currentState, ({ hp }) => ({\n      hp: { ...hp, current: clamp(hp.current + amount, 0, hp.max) },\n    })),\n  ]),\n  // #endregion BASIC\n  // #region EFFECTS\n  'Effect:Dodge': effectFun(() => (origin, play, currentState) => [\n    play,\n    origin === 'Player'\n      ? actions.changeStatusPlayer(currentState, (o) => ({\n          ...o,\n          dodge: { active: true },\n        }))\n      : actions.changeStatusMonster(currentState, currentState.target, (o) => ({\n          ...o,\n          dodge: { active: true },\n        })),\n  ]),\n  'Effect:Armor': effectFun(({ amount }) => (origin, play, currentState) => [\n    play,\n    origin === 'Player'\n      ? actions.changeStatusPlayer(currentState, (o) => ({\n          ...o,\n          armor: { amount: o.armor.amount + amount },\n        }))\n      : actions.changeStatusMonster(currentState, currentState.target, (o) => ({\n          ...o,\n          armor: { amount: o.armor.amount + amount },\n        })),\n  ]),\n  'Effect:Stun': effectFun(() => (origin, play, currentState) => [\n    play,\n    origin === 'Player'\n      ? actions.changeStatusMonster(currentState, currentState.target, (o) => ({\n          ...o,\n          stun: { active: true },\n        }))\n      : actions.changeStatusPlayer(currentState, (o) => ({\n          ...o,\n          stun: { active: true },\n        })),\n  ]),\n  'Effect:Bleed': effectFun(({ target, turns }) => (_, play, currentState) => [\n    play,\n    target === 'Player'\n      ? actions.changeStatusPlayer(currentState, (o) => ({\n          ...o,\n          bleed: { turns: o.bleed.turns + turns },\n        }))\n      : actions.changeStatusMonster(currentState, currentState.target, (o) => ({\n          ...o,\n          bleed: { turns: o.bleed.turns + turns },\n        })),\n  ]),\n  'Effect:Poison': effectFun(({ target, turns }) => (_, play, currentState) => [\n    play,\n    pipe(target === 'Player' ? ('Player' as Target) : currentState.target, (gameTarget) =>\n      applyPoison(play, currentState, { target: gameTarget, turns })\n    ),\n  ]),\n  'Reduce:PoisonBOT': effectFun((params) => (_, play, currentState) => [\n    play,\n    applyPoison(play, currentState, params),\n  ]),\n  'Effect:Stat': effectFun((stats) => (origin, play, currentState) => [\n    play,\n    stats.target === 'Player'\n      ? actions.changeStatPlayer(currentState, (s) => ({\n          hp: {\n            ...s.hp,\n            current: clamp(s.hp.current + (stats.hp ?? 0), 0, s.hp.max),\n          },\n          stamina: {\n            ...s.stamina,\n            current: clamp(s.stamina.current + (stats.stamina ?? 0), 0, s.stamina.max),\n          },\n          speed: {\n            ...s.speed,\n            current: Math.min(s.speed.max, s.speed.current + (stats.speed ?? 0)),\n          },\n          defence: {\n            ...s.defence,\n            current: Math.min(s.defence.max, s.defence.current + (stats.defence ?? 0)),\n          },\n          attack: {\n            ...s.attack,\n            current: Math.min(s.attack.max, s.attack.current + (stats.attack ?? 0)),\n          },\n          staminaPerTurn: {\n            ...s.staminaPerTurn,\n            current: Math.min(\n              s.staminaPerTurn.max,\n              s.staminaPerTurn.current + (stats.staminaPerTurn ?? 0)\n            ),\n          },\n        }))\n      : actions.changeStatMonster(\n          currentState,\n          origin === 'Player' ? currentState.target : origin,\n          (s) => ({\n            hp: {\n              ...s.hp,\n              current: clamp(s.hp.current + (stats.hp ?? 0), 0, s.hp.max),\n            },\n            speed: {\n              ...s.speed,\n              current: Math.min(s.speed.current + (stats.speed ?? 0), s.speed.max),\n            },\n            defence: {\n              ...s.defence,\n              current: Math.min(s.defence.current + (stats.defence ?? 0), s.defence.max),\n            },\n            attack: {\n              ...s.attack,\n              current: Math.min(s.attack.current + (stats.attack ?? 0), s.attack.max),\n            },\n          })\n        ),\n  ]),\n  // #endregion EFFECTS\n  // #region MONSTERS\n  'Monster:Attack': effectFun(({ amount }) => (_origin, play, currentState) => [\n    play,\n    actions.attackPlayer(currentState, amount),\n  ]),\n  'Monster:Summon': effectFun(\n    ({ enemy }) =>\n      (_origin, play, currentState) =>\n        actions.addEnemy(play, currentState, enemies[enemy][0], enemies[enemy][1])\n  ),\n  'Monster:Dead': effectFun(() => (_origin, play, currentState) => [play, currentState]),\n  'Monster:Move': effectFun(() => (origin, play, currentState) => [\n    play,\n    actions.changeDistance(currentState, origin, -2),\n  ]),\n  // #endregion MONSTERS\n  // #region ITEMS\n  'BootsOfFlight:EOT': effectFun(() => (_, play, currentState) => [\n    play,\n    currentState.enemies.reduce(\n      (s, _m, idx) => actions.changeDistance(s, idx as MonsterTarget, 2),\n      currentState\n    ),\n  ]),\n  'Wand:MagicBolt': effectFun(() => (_, play, currentState) => {\n    let state = currentState;\n    while (state.player.stamina.current) {\n      state = actions.modifyPlayerStamina(state, -2);\n      state = actions.attackMonster(state, currentState.target, 1);\n    }\n    return [play, state];\n  }),\n  // #endregion ITEMS\n};\n\nconst applyPoison = (\n  play: Play,\n  currentState: Snapshot,\n  { target, turns }: ReduceFunctionT['Reduce:PoisonBOT']\n) =>\n  pipe(\n    target === 'Player'\n      ? actions.changeStatPlayer(currentState, ({ hp }) => ({\n          hp: { ...hp, current: Math.max(0, hp.current - 1) },\n        }))\n      : actions.changeStatMonster(currentState, currentState.target, ({ hp }) => ({\n          hp: { ...hp, current: Math.max(0, hp.current - 1) },\n        })),\n    (newState) =>\n      turns > 0\n        ? actions.addBotEffect(newState, 'Player', {\n            display: `Poison ${\n              target === 'Player'\n                ? 'Player'\n                : play.enemies[target]!!.lore.name + ' [' + (target + 1) + ']'\n            }`,\n            tooltip: '',\n            range: allRanges,\n            priority: 4,\n            interruptible: false,\n            effects: [effectFunCall(['Reduce:PoisonBOT', { target: target, turns: turns - 1 }])],\n          })\n        : newState\n  );\n\nexport type EffectFunctionT = SystemFunctionT &\n  BasicFunctionT &\n  StatusFunctionT &\n  ReduceFunctionT &\n  MonsterFunctionT &\n  ItemFunctionT;\n\nexport type ReduceFun = (origin: Target, play: Play, newState: Snapshot) => [Play, Snapshot];\nexport type ParametrizedFun<T> = (params: T) => ReduceFun;\nexport type EffectFun<T> = Opaque<ParametrizedFun<T>, ParametrizedFun<T>>;\n\nexport type EffectFunctionRepository = {\n  [k in keyof EffectFunctionT]: (params: EffectFunctionT[k]) => ReduceFun;\n};\nexport type EffectFunRepoIndex = keyof EffectFunctionT & FunIndex;\nexport type EffectFunParams<T extends EffectFunRepoIndex> = Parameters<\n  EffectFunctionRepository[T]\n>[0];\n\n// #endregion\n// #region Modify state\n\nconst updateMonster = (\n  enemies: EnemiesStats,\n  target: Target,\n  override: (stats: EnemyStats) => Partial<EnemyStats>\n): EnemiesStats =>\n  enemies.map((m, idx) => (idx === target ? { ...m, ...override(m) } : m)) as EnemiesStats;\n\nconst updatePlayer = (\n  curr: Snapshot,\n  override: (player: PlayerStats) => Partial<PlayerStats>\n): Snapshot => {\n  return {\n    ...curr,\n    player: { ...curr.player, ...override(curr.player) },\n  };\n};\n\nconst updatePlayerStat = <T extends keyof PlayerStats>(\n  curr: Snapshot,\n  key: T,\n  modify: (player: PlayerStats[T]) => Partial<PlayerStats[T]>\n): Snapshot => {\n  const player = curr.player;\n  player[key] = {\n    ...player[key],\n    ...modify(player[key]),\n  };\n  return {\n    ...curr,\n    player,\n  };\n};\n\nconst actions = {\n  attackPlayer,\n  attackMonster,\n  changeStatPlayer: updatePlayer,\n  changeStatMonster: (\n    curr: Snapshot,\n    target: MonsterTarget,\n    f: (stats: EnemyStats) => Partial<EnemyStats>\n  ): Snapshot => ({\n    ...curr,\n    enemies: updateMonster(curr.enemies, target, f),\n  }),\n  changeStatusPlayer: (curr: Snapshot, updateStatus: (oldStatus: Status) => Status): Snapshot => ({\n    ...curr,\n    player: { ...curr.player, status: updateStatus(curr.player.status) },\n  }),\n  changeStatusMonster: (\n    curr: Snapshot,\n    target: MonsterTarget,\n    updateStatus: (oldStatus: Status) => Status\n  ): Snapshot => ({\n    ...curr,\n    enemies: updateMonster(curr.enemies, target, ({ status }) => ({\n      status: updateStatus(status),\n    })),\n  }),\n  changeDistance: (curr: Snapshot, origin: Target, amount: number): Snapshot => ({\n    ...curr,\n    enemies: updateMonster(curr.enemies, origin, ({ distance }) => ({\n      distance: clamp(distance + amount, 0, 4) as MonsterTarget,\n    })),\n  }),\n  removeMonster: (currPlay: Play, currSnap: Snapshot, target: MonsterTarget): [Play, Snapshot] => [\n    {\n      ...currPlay,\n      enemies: currPlay.enemies.filter((_, idx) => idx === target) as Enemies,\n    },\n    {\n      ...currSnap,\n      target: 0,\n      enemies: currSnap.enemies.filter((_, idx) => idx === target) as EnemiesStats,\n    },\n  ],\n  modifyPlayerStamina: (curr: Snapshot, amount: number): Snapshot =>\n    updatePlayerStat(curr, 'stamina', (stamina) => ({\n      current: clamp(stamina.current + amount, 0, stamina.max),\n    })),\n  addEotEffect: (curr: Snapshot, origin: Target, effect: Effect): Snapshot => ({\n    ...curr,\n    eot: [...(curr.eot ?? []), [origin, effect]],\n  }),\n  addBotEffect: (curr: Snapshot, origin: Target, effect: Effect): Snapshot => ({\n    ...curr,\n    bot: [...(curr.eot ?? []), [origin, effect]],\n  }),\n  addEnemy: (\n    play: Play,\n    curr: Snapshot,\n    enemy: Enemy,\n    enemyStats: EnemyStats\n  ): [Play, Snapshot] => {\n    return play.enemies.length < 5\n      ? [\n          {\n            ...play,\n            enemies: [...play.enemies, enemy] as Enemies,\n          },\n          {\n            ...curr,\n            enemies: [...curr.enemies, enemyStats] as EnemiesStats,\n          },\n        ]\n      : [play, curr];\n  },\n};\n\nfunction attackMonster(curr: Snapshot, target: MonsterTarget, amount: number): Snapshot {\n  const monster = curr.enemies[target]!!;\n  const armor = monster.status.armor.amount;\n  const damage = amount + curr.player.attack.current;\n  const afterDefence = Math.max(damage - monster.defence.current, 0);\n  const afterArmor = Math.max(afterDefence - armor, 0);\n  const armorSpent = armor - (afterDefence - afterArmor);\n  const afterBleed = afterArmor + (monster.status.bleed.turns > 0 ? 1 : 0);\n  return {\n    ...curr,\n    enemies: updateMonster(curr.enemies, target, ({ status, hp }) => ({\n      hp: { ...hp, current: clamp(hp.current - afterBleed, 0, hp.max) },\n      status: { ...status, armor: { amount: armorSpent } },\n    })),\n  };\n}\n\nfunction attackPlayer(curr: Snapshot, amount: number): Snapshot {\n  const armor = curr.player.status.armor.amount;\n  const damage = amount + curr.player.attack.current;\n  const afterDefence = Math.max(damage - curr.player.defence.current, 0);\n  const afterArmor = Math.max(afterDefence - armor, 0);\n  const armorSpent = armor - (afterDefence - afterArmor);\n  const afterBleed = afterArmor + (curr.player.status.bleed.turns > 0 ? 1 : 0);\n  return updatePlayer(curr, ({ hp, status }) => ({\n    hp: { ...hp, current: clamp(hp.current - afterBleed, 0, hp.max) },\n    status: { ...status, armor: { amount: status.armor.amount - armorSpent } },\n  }));\n}\n\n// #endregion\n// #region Stat funs\n\nexport type StatsFunIndex = keyof typeof statsRepository;\nexport const statsRepository = {\n  '+Health': (player: PlayerStats, enemies: EnemiesStats): [PlayerStats, EnemiesStats] => [\n    { ...player, hp: makeStat(player.hp.current + 5) },\n    enemies,\n  ],\n  '+StaPerTurn': (player: PlayerStats, enemies: EnemiesStats): [PlayerStats, EnemiesStats] => [\n    { ...player, staminaPerTurn: makeStat(player.staminaPerTurn.current + 1) },\n    enemies,\n  ],\n  '+Stamina': (player: PlayerStats, enemies: EnemiesStats): [PlayerStats, EnemiesStats] => [\n    {\n      ...player,\n      stamina: makeStat(player.stamina.current + 2, (a) => a),\n    },\n    enemies,\n  ],\n  '+Attack': (player: PlayerStats, enemies: EnemiesStats): [PlayerStats, EnemiesStats] => [\n    { ...player, attack: makeStat(player.attack.current + 1) },\n    enemies,\n  ],\n  '+Speed': (player: PlayerStats, enemies: EnemiesStats): [PlayerStats, EnemiesStats] => [\n    { ...player, speed: makeStat(player.speed.current + 1) },\n    enemies,\n  ],\n  '+Defence': (player: PlayerStats, enemies: EnemiesStats): [PlayerStats, EnemiesStats] => [\n    { ...player, defence: makeStat(player.defence.current + 1) },\n    enemies,\n  ],\n\n  '-Health': (player: PlayerStats, enemies: EnemiesStats): [PlayerStats, EnemiesStats] => [\n    { ...player, hp: makeStat(player.hp.current - 3) },\n    enemies,\n  ],\n  '-StaPerTurn': (player: PlayerStats, enemies: EnemiesStats): [PlayerStats, EnemiesStats] => [\n    { ...player, staminaPerTurn: makeStat(player.staminaPerTurn.current - 1) },\n    enemies,\n  ],\n  '-Stamina': (player: PlayerStats, enemies: EnemiesStats): [PlayerStats, EnemiesStats] => [\n    {\n      ...player,\n      stamina: makeStat(player.stamina.current - 2, (a) => a),\n    },\n    enemies,\n  ],\n  '-Attack': (player: PlayerStats, enemies: EnemiesStats): [PlayerStats, EnemiesStats] => [\n    { ...player, attack: makeStat(player.attack.current - 1) },\n    enemies,\n  ],\n  '-Speed': (player: PlayerStats, enemies: EnemiesStats): [PlayerStats, EnemiesStats] => [\n    { ...player, speed: makeStat(player.speed.current - 1) },\n    enemies,\n  ],\n  '-Defence': (player: PlayerStats, enemies: EnemiesStats): [PlayerStats, EnemiesStats] => [\n    { ...player, defence: makeStat(player.defence.current - 1) },\n    enemies,\n  ],\n};\n\n// #endregion\n\nupdateGlobals({ effects: effectFunRepo });\n","import {\n  Enemies,\n  Player,\n  Snapshot,\n  MonsterTarget,\n  Target,\n  InventoryEffect,\n  EnemiesStats,\n  PlayerStats,\n  Play,\n  RNG,\n  StatsFun,\n  Effect,\n  PlayerTarget,\n  effectFunCall,\n  DisabledSkills,\n  safeEntries,\n  EffectPhase,\n  InventoryStats,\n  Seed,\n  Item,\n} from './types';\nimport { Seq, Set } from 'immutable';\nimport { Chance } from 'chance';\n// @ts-ignore fails on scripts despite having a d.ts file\nimport { toIndexableString } from 'pouchdb-collate';\nimport { extractFunction, statsRepository } from './effectRepository';\nimport { clamp, rangeArr } from './zFunDump';\nimport { allRanges } from './makeGame';\n\nexport const initialState = (play: Play): Snapshot => play.states[0];\nexport const previousState = (play: Play): Snapshot => play.states[play.states.length - 1];\n\n/**\n * @returns min inclusive, max exclusive rand\n */\nfunction turnDeterministicRng(turns: number, randPerTurn: number, monsterSeed: Seed): RNG {\n  const monsterChance = new Chance(monsterSeed);\n  const monsterRng = rangeArr(turns).map((_) =>\n    rangeArr(randPerTurn)\n      // If max === 1, the rng function fails\n      .map((_) => monsterChance.floating({ min: 0, max: 0.9999, fixed: 4 }))\n  );\n  return monsterRng as RNG;\n}\n\nexport const turnRng = (play: Play, turn: number): ((min: number, max: number) => number) => {\n  const turnRng = [...play.rng[turn]];\n  return (min: number, max: number) => Math.floor((max - min) * turnRng.pop()!! + min);\n};\n\nexport const playerPassives = (player: Player): StatsFun[] =>\n  safeEntries(player.build)\n    .flatMap(([_k, s]) => s.passives ?? [])\n    .map((i) => statsRepository[i]);\n\nexport const playerActions = (player: Player, inventoryStats: InventoryStats): InventoryEffect[] =>\n  safeEntries(player.build)\n    .flatMap(([_k, i]) => i.effects ?? [])\n    .filter((e) => (e.amount ?? 999) > (inventoryStats[e.display]?.used ?? 0));\n\nexport const playerItemActions = (\n  player: Player,\n  inventoryStats: InventoryStats\n): [Item, InventoryEffect][] =>\n  safeEntries(player.build)\n    .flatMap(([_k, i]) => (i.effects ?? []).map((e) => [i, e] as [Item, InventoryEffect]))\n    .filter(([i, e]) => (e.amount ?? 999) > (inventoryStats[e.display]?.used ?? 0));\n\nconst enemiesBotEffects = (enemies: Enemies): [MonsterTarget, Effect][] =>\n  enemies\n    .flatMap((e, idx) => (e.bot ?? []).map((eff) => [idx as MonsterTarget, eff] as const))\n    // Sure, typescript\n    .map((a) => [...a]);\n\nconst enemiesEotEffects = (enemies: Enemies): [MonsterTarget, Effect][] =>\n  enemies\n    .flatMap((e, idx) => (e.eot ?? []).map((eff) => [idx as MonsterTarget, eff] as const))\n    // Sure, typescript\n    .map((a) => [...a]);\n\nexport const playerBotEffects = (\n  player: Player,\n  d: DisabledSkills\n): [PlayerTarget, InventoryEffect][] =>\n  safeEntries(player.build)\n    .flatMap(([k, s]) => (!Set(d).has(k) ? s.bot ?? [] : []))\n    .map((a) => ['Player', a]);\n\nexport const playerEotEffects = (\n  player: Player,\n  d: DisabledSkills\n): [PlayerTarget, InventoryEffect][] =>\n  safeEntries(player.build)\n    .flatMap(([k, s]) => (!Set(d).has(k) ? s.eot ?? [] : []))\n    .map((a) => ['Player', a]);\n\nexport const buildPlayer = (\n  player: Player,\n  playerStats: PlayerStats,\n  enemiesStats: EnemiesStats\n): [PlayerStats, EnemiesStats] =>\n  playerPassives(player).reduce(([p, e], fun) => fun(p, e), [playerStats, enemiesStats]);\n\nexport function makeGameNew(\n  player: Player,\n  playerStats: PlayerStats,\n  enemies: Enemies,\n  enemiesStats: EnemiesStats,\n  turns: number,\n  seed: number | string,\n  randPerTurn: number = 20\n): Play {\n  const [playerGameStats, enemyGameStats] = buildPlayer(player, playerStats, enemiesStats);\n  return makeGameNextLevel(\n    player,\n    playerGameStats,\n    enemies,\n    enemyGameStats,\n    {},\n    turns,\n    seed,\n    randPerTurn\n  );\n}\n\nexport function makeGameNextLevel(\n  player: Player,\n  playerStats: PlayerStats,\n  enemies: Enemies,\n  enemiesStats: EnemiesStats,\n  inventoryStats: InventoryStats,\n  turns: number,\n  seed: number | string,\n  randPerTurn: number = 20\n): Play {\n  return {\n    player,\n    enemies,\n    states: [\n      {\n        player: playerStats,\n        enemies: enemiesStats,\n        inventory: inventoryStats,\n        target: 0,\n        lastAttacks: [],\n        disabledSkills: [],\n      },\n    ],\n    rng: turnDeterministicRng(turns, randPerTurn, seed),\n    turns,\n    id: toIndexableString([player, enemies, turns, seed]),\n    seed,\n    version: '1',\n  };\n}\n\nconst reduceFuns = (\n  funs: [Target, Effect][],\n  p: Play,\n  s: Snapshot,\n  phase: EffectPhase\n): [Play, Snapshot] =>\n  Seq(funs)\n    .sortBy(([origin, a]) => {\n      if (a == null) {\n        throw new Error(\n          `Error in ${phase} by ${origin === 'Player' ? 'Player' : p.enemies[origin]?.lore.name}`\n        );\n      }\n      const priorityBonus =\n        origin === 'Player' ? s.player.speed.current : s.enemies[origin]!!.speed.current;\n      return clamp(a.priority - priorityBonus, 0, 4);\n    })\n    .reduce(\n      (acc, value) => {\n        const [origin, effect] = value;\n        const [oldPlay, oldState] = acc;\n        const monsterId = origin === 'Player' ? oldState.target : origin;\n        const targetMonster = oldState.enemies[monsterId]!!;\n\n        const isDeadAttackingMonster = origin !== 'Player' && targetMonster.hp.current <= 0;\n        if (isDeadAttackingMonster) {\n          const newState: Snapshot = {\n            ...oldState,\n            lastAttacks: [\n              ...oldState.lastAttacks,\n              { origin, display: `💀💀DEAD💀💀 ${effect.display}`, phase },\n            ],\n          };\n          return [oldPlay, newState];\n        }\n\n        const isStunnedPlayer =\n          effect.interruptible && origin === 'Player' && oldState.player.status.stun.active;\n        const isStunnedMonster =\n          effect.interruptible && origin !== 'Player' && targetMonster.status.stun.active;\n        const isStunned = isStunnedPlayer || isStunnedMonster;\n        if (isStunned) {\n          const newState: Snapshot = {\n            ...oldState,\n            lastAttacks: [\n              ...oldState.lastAttacks,\n              { origin, display: `💫💫STUNNED💫💫 ${effect.display}`, phase },\n            ],\n          };\n          return [oldPlay, newState];\n        }\n\n        const isInRange = Set([...effect.range]).has(targetMonster.distance);\n        if (!isInRange) {\n          const newState: Snapshot = {\n            ...oldState,\n            lastAttacks: [\n              ...oldState.lastAttacks,\n              { origin, display: `❌❌WHIFFED❌❌ ${effect.display}`, phase },\n            ],\n          };\n          return [oldPlay, newState];\n        }\n\n        const monsterDodged =\n          effect.interruptible && origin === 'Player' && targetMonster.status.dodge.active;\n        if (monsterDodged) {\n          const newState: Snapshot = {\n            ...oldState,\n            enemies: oldState.enemies.map((e, i) =>\n              i === monsterId ? { ...e, status: { ...e.status, dodge: { active: false } } } : e\n            ) as EnemiesStats,\n            lastAttacks: [\n              ...oldState.lastAttacks,\n              { origin, display: `💨💨DODGED💨💨 ${effect.display}`, phase },\n            ],\n          };\n          return [oldPlay, newState];\n        }\n\n        const playerDodged =\n          effect.interruptible && origin !== 'Player' && oldState.player.status.dodge.active;\n        if (playerDodged) {\n          const newState: Snapshot = {\n            ...oldState,\n            player: {\n              ...oldState.player,\n              status: { ...oldState.player.status, dodge: { active: false } },\n            },\n            lastAttacks: [\n              ...oldState.lastAttacks,\n              { origin, display: `💨💨DODGED💨💨 ${effect.display}`, phase },\n            ],\n          };\n          return [oldPlay, newState];\n        }\n\n        const [newPlay, newState] = extractFunction(effect)(origin, oldPlay, oldState);\n        const finalState: Snapshot = {\n          ...newState,\n          lastAttacks: [...newState.lastAttacks, { origin, display: effect.display, phase }],\n        };\n        return [newPlay, finalState];\n      },\n      [p, s]\n    );\n\nconst applyEffectStamina = (amount: number): Effect => ({\n  display: `${amount >= 0 ? '+' : ''}${amount} 💪`,\n  tooltip: `Use ${amount} stamina`,\n  effects: [effectFunCall(['Basic:Stamina', { amount }])],\n  range: allRanges,\n  priority: 0,\n  interruptible: false,\n});\n\nconst effectEotCleanup: Effect = {\n  display: 'Cleanup',\n  tooltip: 'Cleanup',\n  effects: [effectFunCall('Utility:Cleanup')],\n  range: allRanges,\n  priority: 0,\n  interruptible: false,\n};\n\nconst effectDead: Effect = {\n  display: '⚰',\n  tooltip: '⚰',\n  priority: 4,\n  effects: [effectFunCall('Monster:Dead')],\n  range: allRanges,\n  interruptible: false,\n};\n\nexport const handlePlayerEffect = (play: Play, index: number): Play => {\n  const lastTurnState = previousState(play);\n  const usedSkill = playerActions(play.player, lastTurnState.inventory)[index];\n  const bot = lastTurnState.bot ?? [];\n  const eot = lastTurnState.eot ?? [];\n\n  const initialState: Snapshot = {\n    ...lastTurnState,\n    lastAttacks: [],\n    bot: undefined,\n    eot: undefined,\n    inventory: {\n      ...lastTurnState.inventory,\n      [usedSkill.display]: {\n        used: 1 + (lastTurnState.inventory[usedSkill.display]?.used ?? 0),\n      },\n    },\n  };\n\n  // BOT\n  // Lingering effects\n  const [postBotPlay, postBotState] = reduceFuns(bot, play, initialState, 'BOT');\n  // Player & Monster effects\n  const playerBotEffs = playerBotEffects(postBotPlay.player, postBotState.disabledSkills);\n\n  const entitiesBot: [Target, Effect][] = [\n    ...playerBotEffs,\n    ...enemiesBotEffects(postBotPlay.enemies),\n  ];\n  const [postEntitiesBotPlay, postEntitiesBotState] = reduceFuns(\n    entitiesBot,\n    postBotPlay,\n    postBotState,\n    'BOT'\n  );\n\n  // Turn\n  const rand = turnRng(postEntitiesBotPlay, postEntitiesBotPlay.states.length);\n  const turnFunctions: [Target, Effect][] = Seq(postEntitiesBotPlay.enemies)\n    .zip(Seq(postEntitiesBotState.enemies))\n    .map(([e, stats], idx) => {\n      if (stats.hp.current > 0) {\n        const rolls = e.rolls[stats.distance];\n        const roll = rand(0, e.rolls[stats.distance].length);\n        // if (isNaN(roll)) {\n        //   throw new Error('Out of RNG exception');\n        // }\n        const effect = e.effects[rolls[roll]];\n        // if (effect == null) {\n        //   throw new Error(`Rolled outside the table ${JSON.stringify({ roll, rolls, effects: e.effects })}`);\n        // }\n        return [idx as Target, effect] as const;\n      } else {\n        return [idx as Target, effectDead] as const;\n      }\n    })\n    .concat([['Player' as Target, usedSkill] as const])\n    .toArray()\n    // Sure, typescript\n    .map((a) => [...a]);\n\n  const [newPlay, newState] = reduceFuns(\n    turnFunctions,\n    postEntitiesBotPlay,\n    postEntitiesBotState,\n    'MAIN'\n  );\n\n  // EOT\n  // Player & Monster effects\n  const playerEotEffs = playerEotEffects(newPlay.player, newState.disabledSkills);\n  const entitiesEot = [...playerEotEffs, ...enemiesEotEffects(newPlay.enemies)];\n  const [postPlayerEotPlay, postPlayerEotState] = reduceFuns(entitiesEot, newPlay, newState, 'EOT');\n  // Lingering effects\n  const [postEotPlay, postEotState] = reduceFuns(eot, postPlayerEotPlay, postPlayerEotState, 'EOT');\n  // Stamina\n  const passivesStamina = [...playerBotEffs, ...playerEotEffs].reduce(\n    (acc, e) => acc + e[1].stamina,\n    0\n  );\n  const [postStaminaPlay, postStaminaState] = reduceFuns(\n    [\n      [\n        'Player',\n        applyEffectStamina(\n          lastTurnState.player.staminaPerTurn.current - usedSkill.stamina - passivesStamina\n        ),\n      ],\n    ],\n    postEotPlay,\n    postEotState,\n    'EOT'\n  );\n\n  // Cleanup\n  const [postCleanup, postCleanupState] = reduceFuns(\n    [['Player' as Target, effectEotCleanup]],\n    postStaminaPlay,\n    postStaminaState,\n    'CLEANUP'\n  );\n\n  const endOfTurn: Play = {\n    ...postCleanup,\n    states: [...postCleanup.states, postCleanupState],\n  };\n\n  return endOfTurn;\n};\n\nexport const setSelected = (play: Play, target: MonsterTarget): Play => {\n  play.states[play.states.length - 1].target = target;\n  return {\n    ...play,\n    states: [...play.states],\n  };\n};\n\nexport const setDisabledSkills = (play: Play, disabled: DisabledSkills): Play => {\n  play.states[play.states.length - 1].disabledSkills = disabled;\n  return {\n    ...play,\n    states: [...play.states],\n  };\n};\n\nexport type PlayState = 'win' | 'loss' | 'playing';\n\nexport const playState = (play: Play): PlayState => {\n  const state = previousState(play);\n  return play.states.length > play.turns || state.player.hp.current <= 0\n    ? 'loss'\n    : state.enemies.reduce((acc, monster) => acc + monster.hp.current, 0) <= 0\n    ? 'win'\n    : 'playing';\n};\n\nexport const scoreGame = (play: Play): number => {\n  const firstState = initialState(play);\n  const lastState = previousState(play);\n\n  const turns = play.states.length; // 1-50\n  const hpLoss =\n    Math.max(0, firstState.player.hp.max - lastState.player.hp.current) / firstState.player.hp.max; // 0-1\n  const staminaLoss =\n    Math.max(0, firstState.player.stamina.max - lastState.player.stamina.current) /\n    firstState.player.hp.max; // 0-1\n  const enemies = lastState.enemies.length; // 1-5\n\n  return Math.floor(enemies * (500 * hpLoss + 150 * staminaLoss + (500 - turns * 10)));\n};\n","import { allRanges, defaultStatus, makeRange, makeStat, selfRange } from '../makeGame';\nimport { effectFunCall, EnemyRepository } from '../types';\n\nexport type EnemiesIndex = 'piripuru' | 'toros' | 'purupuri' | 'ninkujorua' | 'tshopuritazios';\nconst enemies = {\n  piripuru: [\n    {\n      lore: {\n        name: 'Piripuru',\n      },\n      rolls: [[1], [1, 1, 1, 0], [1, 0], [0], [0]],\n      effects: [\n        {\n          display: 'Bounce',\n          tooltip: 'Floomp Floomp',\n          priority: 1,\n          interruptible: false,\n          effects: [effectFunCall(['Monster:Move', { amount: -2 }])],\n          range: selfRange,\n        },\n\n        {\n          display: 'Slam',\n          tooltip: 'Throws itself at you',\n          priority: 3,\n          interruptible: true,\n          effects: [effectFunCall(['Monster:Attack', { amount: 5 }])],\n          range: makeRange(0, 1),\n        },\n      ],\n    },\n    {\n      hp: makeStat(7),\n      distance: 4,\n      speed: makeStat(0),\n      attack: makeStat(0),\n      defence: makeStat(0),\n      status: defaultStatus,\n    },\n  ],\n  toros: [\n    {\n      lore: {\n        name: 'Toros',\n        description: 'Big, mean, strong and unclean',\n      },\n      rolls: [\n        [1, 1, 1, 2, 2, 0],\n        [1, 2, 2, 2, 2, 0],\n        [2, 2, 3, 3, 4, 0],\n        [2, 3, 3, 4, 0],\n        [3, 3, 3, 4, 4, 0],\n      ],\n      effects: [\n        {\n          display: 'Rest',\n          tooltip: \"It won't be long until the massacre continues\",\n          priority: 1,\n          interruptible: false,\n          effects: [effectFunCall(['Effect:Stat', { target: 'Monster', hp: 1 }])],\n          range: selfRange,\n        },\n\n        {\n          display: 'Chomp',\n          tooltip: 'Toro attempts to eat you for massive damage!',\n          priority: 4,\n          interruptible: true,\n          effects: [effectFunCall(['Monster:Attack', { amount: 18 }])],\n          range: makeRange(0),\n        },\n\n        {\n          display: 'Swipe',\n          tooltip: 'High damage attack that staggers',\n          priority: 3,\n          interruptible: true,\n          effects: [\n            effectFunCall(['Monster:Attack', { amount: 12 }]),\n            effectFunCall(['Monster:Move', { amount: -1 }]),\n            effectFunCall('Effect:Stun'),\n          ],\n          range: makeRange(0, 1, 2),\n        },\n\n        {\n          display: 'Lunge',\n          tooltip: 'Charges forward for a horn attack',\n          priority: 4,\n          interruptible: true,\n          effects: [\n            effectFunCall(['Monster:Attack', { amount: 10 }]),\n            effectFunCall(['Monster:Move', { amount: -5 }]),\n          ],\n          range: makeRange(3, 4),\n        },\n\n        {\n          display: 'Roar',\n          tooltip: 'A terrifying howl!',\n          priority: 3,\n          interruptible: false,\n          effects: [effectFunCall(['Basic:Stamina', { amount: -5 }])],\n          range: allRanges,\n        },\n      ],\n    },\n    {\n      hp: makeStat(38),\n      distance: 2,\n      speed: makeStat(0),\n      attack: makeStat(0),\n      defence: makeStat(0),\n      status: defaultStatus,\n    },\n  ],\n\n  purupuri: [\n    {\n      lore: {\n        name: 'Mama Purupuri',\n        description: 'Mama can always call one of its little ones to help',\n      },\n      rolls: [\n        [1, 1, 1, 1, 0],\n        [1, 1, 1, 1, 2, 0],\n        [1, 1, 1, 1, 2, 0],\n        [2, 2, 0],\n        [2, 2, 0],\n      ],\n      effects: [\n        {\n          display: 'Recover',\n          tooltip: 'Mama needs its rest',\n          priority: 1,\n          interruptible: false,\n          effects: [effectFunCall(['Effect:Stat', { target: 'Monster', hp: 3 }])],\n          range: selfRange,\n        },\n\n        {\n          display: 'Stomp',\n          tooltip: 'Quickly, out of the way!',\n          priority: 3,\n          interruptible: true,\n          effects: [effectFunCall(['Monster:Attack', { amount: 8 }]), effectFunCall('Effect:Stun')],\n          range: makeRange(0, 1),\n        },\n\n        {\n          display: 'Call for Aid',\n          tooltip: 'Calls for the litter to help',\n          priority: 3,\n          interruptible: false,\n          effects: [\n            effectFunCall(['Monster:Summon', { enemy: 'piripuru' }]),\n            effectFunCall(['Effect:Stat', { target: 'Monster', hp: -5 }]),\n            effectFunCall(['Monster:Move', { amount: -2 }]),\n          ],\n          range: allRanges,\n        },\n      ],\n    },\n    {\n      hp: makeStat(50),\n      distance: 3,\n      speed: makeStat(0),\n      attack: makeStat(0),\n      defence: makeStat(0),\n      status: defaultStatus,\n    },\n  ],\n\n  ninkujorua: [\n    {\n      lore: {\n        name: 'Ninkujorua',\n        description: 'Just...stay...still...for...a...second',\n      },\n      rolls: [\n        [1, 1, 1, 2, 2, 2, 0],\n        [1, 1, 1, 2, 2, 2, 0],\n        [1, 1, 2, 2, 2, 0],\n        [1, 2, 3, 0],\n        [2, 3, 0],\n      ],\n      effects: [\n        {\n          display: 'Meditate',\n          tooltip: 'And not about good vibes',\n          priority: 1,\n          interruptible: false,\n          effects: [\n            effectFunCall(['Effect:Stat', { target: 'Monster', attack: 1 }]),\n            effectFunCall(['Monster:Move', { amount: 999 }]),\n            effectFunCall('Effect:Dodge'),\n          ],\n          range: selfRange,\n        },\n\n        {\n          display: 'Rapid Slash - Retreat!',\n          tooltip: 'Deals several strikes then moves away from the player',\n          priority: 2,\n          interruptible: true,\n          effects: [\n            effectFunCall(['Monster:Move', { amount: -5 }]),\n            effectFunCall(['Monster:Attack', { amount: 2 }]),\n            effectFunCall(['Monster:Attack', { amount: 2 }]),\n            effectFunCall(['Monster:Attack', { amount: 2 }]),\n            effectFunCall('Effect:Dodge'),\n          ],\n          range: allRanges,\n        },\n\n        {\n          display: 'Rapid Slash - Advance!',\n          tooltip: 'Moves close to the player then deals several strikes',\n          priority: 2,\n          interruptible: true,\n          effects: [\n            effectFunCall(['Monster:Move', { amount: -5 }]),\n            effectFunCall(['Monster:Attack', { amount: 2 }]),\n            effectFunCall(['Monster:Attack', { amount: 2 }]),\n            effectFunCall(['Monster:Attack', { amount: 2 }]),\n          ],\n          range: allRanges,\n        },\n\n        {\n          display: 'Back Spikes',\n          tooltip: 'Jumps and shoots several needles that cause bleed',\n          priority: 4,\n          interruptible: true,\n          effects: [\n            effectFunCall(['Monster:Attack', { amount: 1 }]),\n            effectFunCall(['Monster:Attack', { amount: 1 }]),\n            effectFunCall(['Effect:Bleed', { target: 'Player', turns: 3 }]),\n          ],\n          range: makeRange(3, 4),\n        },\n      ],\n    },\n    {\n      hp: makeStat(25),\n      distance: 1,\n      speed: makeStat(0),\n      attack: makeStat(0),\n      defence: makeStat(0),\n      status: defaultStatus,\n    },\n  ],\n\n  tshopuritazios: [\n    {\n      lore: {\n        name: 'Tshopuritazios',\n        description: 'A filth bird whose stench hits a mile away',\n      },\n      rolls: [\n        [1, 1, 1, 2, 2, 2, 0],\n        [1, 1, 1, 2, 2, 2, 0],\n        [1, 1, 2, 2, 2, 0],\n        [1, 2, 3, 0],\n        [2, 3, 0],\n      ],\n      effects: [\n        {\n          display: 'Goad',\n          tooltip: \"Sounds like it's laughing at you\",\n          priority: 1,\n          interruptible: false,\n          effects: [\n            effectFunCall(['Effect:Stat', { target: 'Player', defence: -1, attack: -1 }]),\n            effectFunCall(['Monster:Move', { amount: 999 }]),\n          ],\n          range: selfRange,\n        },\n\n        {\n          display: 'Peck',\n          tooltip: 'What is worse, the force or the texture?',\n          priority: 3,\n          interruptible: true,\n          effects: [\n            effectFunCall(['Monster:Attack', { amount: 10 }]),\n            effectFunCall('Effect:Stun'),\n            effectFunCall(['Monster:Move', { amount: 2 }]),\n          ],\n          range: makeRange(0, 1),\n        },\n\n        {\n          display: 'Fling Mud',\n          tooltip: 'A large chunk coming right at you!',\n          priority: 3,\n          interruptible: true,\n          effects: [\n            effectFunCall(['Monster:Attack', { amount: 2 }]),\n            effectFunCall(['Monster:Attack', { amount: 2 }]),\n            effectFunCall(['Monster:Attack', { amount: 8 }]),\n            effectFunCall(['Monster:Move', { amount: 1 }]),\n          ],\n          range: makeRange(1, 2, 3),\n        },\n\n        {\n          display: 'Spit Bile',\n          tooltip: 'This disgusting liquid corrodes your armor',\n          priority: 3,\n          interruptible: true,\n          effects: [\n            effectFunCall(['Monster:Attack', { amount: 1 }]),\n            effectFunCall(['Monster:Attack', { amount: 1 }]),\n            effectFunCall(['Effect:Poison', { target: 'Player', turns: 3 }]),\n            effectFunCall(['Effect:Stat', { target: 'Player', defence: -1 }]),\n          ],\n          range: makeRange(2, 3, 4),\n        },\n      ],\n    },\n    {\n      hp: makeStat(32),\n      distance: 4,\n      speed: makeStat(0),\n      attack: makeStat(0),\n      defence: makeStat(0),\n      status: defaultStatus,\n    },\n  ],\n};\n\nexport default enemies as EnemyRepository;\n","import { Item } from '../types';\n\nexport type ArmorsIndex = keyof typeof armors;\nexport type Armors = { [k in ArmorsIndex]: Item };\nconst armors = {\n  heavy: {\n    display: 'Heavy',\n    passives: ['+Defence', '+Defence', '+Defence', '+Defence', '-Speed', '-StaPerTurn'],\n  },\n  medium: {\n    display: 'Medium',\n    passives: ['+Defence', '+Defence', '-StaPerTurn'],\n  },\n  light: {\n    display: 'Light',\n    passives: ['+Defence'],\n  },\n  none: {\n    display: 'None',\n    passives: ['+Speed'],\n  },\n};\n\nexport default armors as Armors;\n","import { Item } from '../types';\n\nexport type CharmsIndex = keyof typeof charms;\nexport type Charms = { [k in CharmsIndex]: Item };\nexport const charms = {\n  health: {\n    display: 'of Health',\n    passives: ['+Health'],\n    tooltip: 'Increases your maximum health',\n  },\n  haste: {\n    display: 'of Haste',\n    passives: ['+StaPerTurn'],\n    tooltip: 'Increases your maximum stamina regeneration',\n  },\n  resilience: {\n    display: 'of Resilience',\n    passives: ['+Stamina'],\n    tooltip: 'Increases your maximum stamina',\n  },\n  strength: {\n    display: 'of Strength',\n    passives: ['+Attack', '-Defence'],\n    tooltip: 'Increases your maximum attack',\n  },\n  swiftness: {\n    display: 'of Swiftness',\n    passives: ['+Speed', '-Attack'],\n    tooltip: 'Increases your maximum speed',\n  },\n  defence: {\n    display: 'of Defence',\n    passives: ['+Defence', '-Speed'],\n    tooltip: 'Increases your maximum defence',\n  },\n};\n\nexport default charms as Charms;\n","import { makeRange, selfRange } from '../makeGame';\nimport { Item, effectFunCall } from '../types';\n\nexport type ClassesIndex = keyof typeof classes;\nexport type Classes = { [k in ClassesIndex]: Item };\nconst classes = {\n  warrior: {\n    display: 'Warrior',\n    passives: ['+Attack', '+Defence', '+Stamina'],\n    effects: [\n      {\n        display: 'Well placed kick',\n        tooltip: 'Last resource attack',\n        effects: [effectFunCall(['Basic:Attack', { amount: 2 }])],\n        priority: 2,\n        interruptible: true,\n        stamina: 1,\n        range: makeRange(0, 1),\n      },\n    ],\n  },\n  rogue: {\n    display: 'Rogue',\n    passives: ['+Speed', '+Speed', '-Stamina'],\n    effects: [\n      {\n        display: 'Strategic Retreat',\n        tooltip: 'Jump backwards',\n        effects: [effectFunCall(['Basic:Move', { amount: 999 }])],\n        priority: 2,\n        interruptible: false,\n        stamina: 1,\n        range: selfRange,\n      },\n    ],\n  },\n  berserk: {\n    display: 'Berserk',\n    passives: ['+Attack', '+Attack', '+StaPerTurn', '-Defence', '-Health'],\n    effects: [\n      {\n        display: 'All or Nothing!',\n        tooltip: 'Deals massive damage and leaves you weakened',\n        priority: 2,\n        interruptible: true,\n        stamina: 0,\n        range: makeRange(0, 1, 2),\n        amount: 1,\n        effects: [\n          effectFunCall(['Basic:Move', { amount: -5 }]),\n          effectFunCall(['Basic:Attack', { amount: 2 }]),\n          effectFunCall(['Basic:Attack', { amount: 2 }]),\n          effectFunCall(['Basic:Attack', { amount: 2 }]),\n          effectFunCall(['Basic:Attack', { amount: 2 }]),\n          effectFunCall(['Effect:Stat', { target: 'Player', defence: -3, speed: -1 }]),\n        ],\n      },\n    ],\n  },\n  mage: {\n    display: 'Mage',\n    passives: ['+StaPerTurn', '+Stamina', '-Health'],\n    effects: [\n      {\n        display: 'Just having a thought',\n        tooltip: 'Restores stamina for the next action',\n        priority: 4,\n        interruptible: false,\n        amount: 2,\n        stamina: 0,\n        range: selfRange,\n        effects: [effectFunCall(['Basic:Stamina', { amount: 999 }])],\n      },\n    ],\n  },\n  cleric: {\n    display: 'Cleric',\n    passives: ['+Defence', '+Stamina'],\n    effects: [\n      {\n        display: 'Minor Healing',\n        tooltip: 'Restores some HP',\n        amount: 3,\n        effects: [effectFunCall(['Basic:HP', { amount: 5 }])],\n        priority: 3,\n        interruptible: false,\n        stamina: 3,\n        range: selfRange,\n      },\n    ],\n  },\n};\n\nexport default classes as Classes;\n","import { selfRange } from '../makeGame';\nimport { Item, effectFunCall } from '../types';\n\nexport type ConsumablesIndex = keyof typeof consumables;\nexport type Consumables = { [k in ConsumablesIndex]: Item };\nexport const consumables = {\n  healing: {\n    display: 'Healing Potion',\n    effects: [\n      {\n        display: 'Healing!',\n        tooltip: 'Restores some HP',\n        effects: [effectFunCall(['Basic:HP', { amount: 4 }])],\n        priority: 4,\n        interruptible: false,\n        stamina: 5,\n        amount: 3,\n        range: selfRange,\n      },\n    ],\n  },\n  razors: {\n    display: 'Pot of Razors',\n    effects: [\n      {\n        display: 'Throw pot',\n        tooltip: 'Causes bleeding',\n        amount: 2,\n        effects: [effectFunCall(['Effect:Bleed', { target: 'Monster', turns: 3 }])],\n        priority: 4,\n        interruptible: true,\n        stamina: 5,\n        range: selfRange,\n      },\n    ],\n  },\n  bubble: {\n    display: 'Life Bubble',\n    effects: [\n      {\n        display: 'Activate Bubble',\n        tooltip: 'Protects against a single source of damage this turn',\n        effects: [effectFunCall('Effect:Dodge')],\n        priority: 1,\n        interruptible: false,\n        stamina: 1,\n        amount: 1,\n        range: selfRange,\n      },\n    ],\n  },\n  rock: {\n    display: 'Pet Rock',\n    effects: [\n      {\n        display: 'Rock, to me!',\n        tooltip: 'Reduces damage',\n        effects: [effectFunCall(['Effect:Armor', { amount: 3 }])],\n        priority: 2,\n        interruptible: false,\n        stamina: 3,\n        amount: 3,\n        range: selfRange,\n      },\n    ],\n  },\n};\n\nexport default consumables as Consumables;\n","import { selfRange, allRanges } from '../makeGame';\nimport { Item, effectFunCall } from '../types';\n\nexport type FootwearsIndex = keyof typeof footwears;\nexport type Footwears = { [k in FootwearsIndex]: Item };\nexport const footwears = {\n  slippers: {\n    display: 'Slippers of Dooooodge!',\n    tooltip: 'Allows you to dodge attacks',\n    effects: [\n      {\n        display: 'Advanced Dodge',\n        tooltip: 'Avoid 1 attack',\n        effects: [effectFunCall('Effect:Dodge')],\n        priority: 1,\n        interruptible: false,\n        stamina: 3,\n        range: selfRange,\n      },\n    ],\n  },\n  boots: {\n    display: 'Boots of Flight',\n    tooltip: 'Avoid your enemies',\n    eot: [\n      {\n        display: 'Flight!',\n        tooltip: 'Increases distance at the end of the turn',\n        priority: 0,\n        interruptible: false,\n        range: allRanges,\n        stamina: 2,\n        effects: [effectFunCall('BootsOfFlight:EOT')],\n      },\n    ],\n  },\n  greaves: {\n    display: 'Greaves of Stability',\n    tooltip: 'Extra resilient',\n    passives: ['-StaPerTurn'],\n    effects: [\n      {\n        display: 'Dig your heels',\n        tooltip: 'Resists damage',\n        effects: [effectFunCall(['Effect:Armor', { amount: 3 }])],\n        priority: 1,\n        interruptible: false,\n        stamina: 4,\n        range: selfRange,\n      },\n    ],\n  },\n};\n\nexport default footwears as Footwears;\n","import { makeRange } from '../makeGame';\nimport { Item, effectFunCall } from '../types';\n\nexport type HeadgearsIndex = keyof typeof headgears;\nexport type Headgears = { [k in HeadgearsIndex]: Item };\nexport const headgears = {\n  helm: {\n    display: 'Helm',\n    passives: ['+Defence', '+Defence', '-StaPerTurn'],\n    tooltip: 'Big protection for slow combatants',\n  },\n  cap: {\n    display: 'Feather Cap',\n    passives: ['+StaPerTurn', '+Stamina'],\n    tooltip: \"Makes you feel energized, doesn't it?\",\n  },\n  magehat: {\n    display: 'Mage Hat',\n    tooltip: 'Small tricks for big plays',\n    effects: [\n      {\n        display: 'Flash!',\n        tooltip: 'Blinks you to a better position',\n        effects: [\n          effectFunCall(['Basic:Attack', { amount: 1 }]),\n          effectFunCall(['Basic:Move', { amount: 2 }]),\n        ],\n        priority: 3,\n        interruptible: true,\n        stamina: 4,\n        range: makeRange(1, 2),\n      },\n    ],\n  },\n};\n\nexport default headgears as Headgears;\n","import { makeRange, selfRange } from '../makeGame';\nimport { Item, effectFunCall } from '../types';\n\nexport type OffhandsIndex = keyof typeof offhands;\nexport type Offhands = { [k in OffhandsIndex]: Item };\nconst offhands = {\n  hook: {\n    display: 'Hook',\n    effects: [\n      {\n        display: 'Get over here!',\n        tooltip: 'Moves enemy closer',\n        effects: [\n          effectFunCall(['Basic:Attack', { amount: 3 }]),\n          effectFunCall(['Basic:Move', { amount: -2 }]),\n        ],\n        priority: 4,\n        interruptible: true,\n        stamina: 3,\n        range: makeRange(2, 3, 4),\n      },\n    ],\n  },\n  parry: {\n    display: 'Parry Dagger',\n    effects: [\n      {\n        display: 'Get over here!',\n        tooltip: 'Avoids a melee attack',\n        effects: [effectFunCall('Effect:Dodge')],\n        priority: 2,\n        interruptible: false,\n        stamina: 2,\n        range: makeRange(1),\n      },\n    ],\n  },\n  shield: {\n    display: 'Shield',\n    passives: ['+Defence', '-StaPerTurn'],\n    effects: [\n      {\n        display: 'Not today!',\n        tooltip: 'Blocks a lot of damage',\n        effects: [effectFunCall(['Effect:Armor', { amount: 5 }])],\n        priority: 2,\n        interruptible: false,\n        stamina: 4,\n        range: selfRange,\n      },\n    ],\n  },\n  focus: {\n    display: 'Focus',\n    passives: ['+Speed', '+StaPerTurn'],\n  },\n  wand: {\n    display: 'Wand',\n    passives: ['-Defence'],\n    effects: [\n      {\n        display: 'Magic Bolt',\n        tooltip: 'Shoots mana bolts until the caster faints',\n        effects: [effectFunCall('Wand:MagicBolt')],\n        priority: 3,\n        interruptible: true,\n        stamina: 1,\n        range: makeRange(3, 4),\n      },\n    ],\n  },\n};\n\nexport default offhands as Offhands;\n","import { selfRange, makeRange } from '../makeGame';\nimport { Item, effectFunCall } from '../types';\n\nexport type SkillsIndex = keyof typeof skills;\nexport type Skills = { [k in SkillsIndex]: Item };\nconst skills = {\n  sturdy: {\n    display: 'Sturdy',\n    bot: [\n      {\n        display: 'Endure the pain',\n        tooltip: 'Blocks some damage each turn at the cost of stamina',\n        stamina: 2,\n        effects: [effectFunCall(['Effect:Armor', { amount: 4 }])],\n        priority: 1,\n        interruptible: false,\n        range: selfRange,\n      },\n    ],\n  },\n  nimble: {\n    display: 'Nimble',\n    effects: [\n      {\n        display: 'Dodge',\n        tooltip: 'Avoid one enemy attack',\n        effects: [effectFunCall('Effect:Dodge')],\n        priority: 2,\n        interruptible: false,\n        stamina: 4,\n        range: selfRange,\n      },\n    ],\n  },\n  resourceful: {\n    display: 'Resourceful',\n    effects: [\n      {\n        display: 'Dodge this!',\n        tooltip: 'Throws a stone',\n        effects: [effectFunCall(['Basic:Attack', { amount: 2 }])],\n        priority: 3,\n        interruptible: true,\n        stamina: 3,\n        range: makeRange(3, 4),\n      },\n    ],\n  },\n};\n\nexport default skills as Skills;\n","import { makeRange, allRanges } from '../makeGame';\nimport { Item, effectFunCall } from '../types';\n\nexport type WeaponsIndex = keyof typeof weapons;\nexport type Weapons = { [k in WeaponsIndex]: Item };\nconst weapons = {\n  sword: {\n    display: 'Sword',\n    tooltip: 'All-rounder',\n    effects: [\n      {\n        display: 'Slash',\n        tooltip: 'Swings at the enemy',\n        effects: [effectFunCall(['Basic:Attack', { amount: 2 }])],\n        priority: 3,\n        interruptible: true,\n        stamina: 2,\n        range: makeRange(0, 1),\n      },\n      {\n        display: 'Pommel Hit',\n        tooltip: 'Deals a quick blow',\n        effects: [effectFunCall(['Basic:Attack', { amount: 2 }])],\n        priority: 2,\n        interruptible: true,\n        stamina: 2,\n        range: makeRange(0),\n      },\n      {\n        display: 'Overhead Slice',\n        tooltip: 'Moves into melee and deals a heavy blow',\n        effects: [\n          effectFunCall(['Basic:Move', { amount: -1 }]),\n          effectFunCall(['Basic:Attack', { amount: 4 }]),\n        ],\n        priority: 4,\n        interruptible: true,\n        stamina: 3,\n        range: makeRange(1),\n      },\n    ],\n  },\n  greatsword: {\n    display: 'Greatsword',\n    tooltip: 'Specialized in big damage',\n    effects: [\n      {\n        display: 'Rend',\n        tooltip: 'Swings at the enemy',\n        effects: [effectFunCall(['Basic:Attack', { amount: 3 }])],\n        priority: 4,\n        interruptible: true,\n        stamina: 4,\n        range: makeRange(0, 1),\n      },\n      {\n        display: 'Feint',\n        tooltip: 'Quick step backwards',\n        effects: [effectFunCall(['Basic:Move', { amount: 1 }])],\n        priority: 1,\n        interruptible: false,\n        stamina: 1,\n        range: makeRange(0, 1),\n      },\n      {\n        display: 'Earth Flattener',\n        tooltip: 'Charges a monstruous stunning blow',\n        effects: [effectFunCall(['Basic:Move', { amount: 5 }]), effectFunCall('Effect:Stun')],\n        priority: 4,\n        interruptible: true,\n        stamina: 6,\n        range: makeRange(1),\n      },\n    ],\n  },\n  twinblades: {\n    display: 'Twinblades',\n    tooltip: 'Specialized in mobility',\n    effects: [\n      {\n        display: 'Swoosh',\n        tooltip: 'Deals a strike and moves back',\n        effects: [\n          effectFunCall(['Basic:Attack', { amount: 2 }]),\n          effectFunCall(['Basic:Move', { amount: 1 }]),\n        ],\n        priority: 2,\n        interruptible: true,\n        stamina: 2,\n        range: makeRange(0, 1),\n      },\n      {\n        display: 'Fiuuum',\n        tooltip: 'Jump attack',\n        effects: [\n          effectFunCall(['Basic:Move', { amount: -2 }]),\n          effectFunCall(['Basic:Attack', { amount: 3 }]),\n        ],\n        priority: 4,\n        interruptible: true,\n        stamina: 3,\n        range: makeRange(2, 3),\n      },\n      {\n        display: 'SwishSwishSwishSwish',\n        tooltip: 'Deals multiple low damage hits',\n        effects: [\n          effectFunCall(['Basic:Attack', { amount: 1 }]),\n          effectFunCall(['Basic:Attack', { amount: 1 }]),\n          effectFunCall(['Basic:Attack', { amount: 1 }]),\n          effectFunCall(['Basic:Attack', { amount: 1 }]),\n        ],\n        priority: 3,\n        interruptible: true,\n        stamina: 4,\n        range: makeRange(0),\n      },\n    ],\n  },\n  katana: {\n    display: 'Katana',\n    tooltip: 'Specialized in bleeding',\n    effects: [\n      {\n        display: 'Slice & Dice',\n        tooltip: 'Deals two swift strikes',\n        effects: [\n          effectFunCall(['Basic:Attack', { amount: 1 }]),\n          effectFunCall(['Basic:Attack', { amount: 1 }]),\n        ],\n        priority: 3,\n        interruptible: true,\n        stamina: 2,\n        range: makeRange(0, 1),\n      },\n      {\n        display: 'Wakizashi',\n        tooltip: 'Short sword with a quick attack causing bleeding',\n        effects: [\n          effectFunCall(['Basic:Attack', { amount: 1 }]),\n          effectFunCall(['Effect:Bleed', { target: 'Monster', turns: 2 }]),\n        ],\n        priority: 2,\n        interruptible: true,\n        stamina: 4,\n        range: makeRange(0, 1),\n      },\n      {\n        display: 'Unsheathe',\n        tooltip: 'Dodges the next attack and deals damage',\n        effects: [effectFunCall('Effect:Dodge'), effectFunCall(['Basic:Attack', { amount: 3 }])],\n        priority: 1,\n        interruptible: true,\n        stamina: 4,\n        range: makeRange(0),\n      },\n    ],\n  },\n  axe: {\n    display: 'Axe',\n    tooltip: 'Specialized in debuffs',\n    effects: [\n      {\n        display: 'Chop',\n        tooltip: 'A slow but reliable attack',\n        effects: [effectFunCall(['Basic:Attack', { amount: 2 }])],\n        priority: 4,\n        interruptible: true,\n        stamina: 3,\n        range: makeRange(0, 1),\n      },\n      {\n        display: 'Aim for the head!',\n        tooltip: 'Cripples the monster',\n        effects: [\n          effectFunCall(['Effect:Stat', { target: 'Monster', defence: -1 }]),\n          effectFunCall(['Effect:Bleed', { target: 'Player', turns: 2 }]),\n        ],\n        priority: 4,\n        interruptible: true,\n        stamina: 5,\n        range: makeRange(1),\n      },\n      {\n        display: 'Target the limbs!',\n        tooltip: 'Weakens the monster',\n        effects: [\n          effectFunCall(['Effect:Stat', { target: 'Monster', attack: -1 }]),\n          effectFunCall(['Effect:Bleed', { target: 'Player', turns: 2 }]),\n        ],\n        priority: 4,\n        interruptible: true,\n        stamina: 5,\n        range: makeRange(1),\n      },\n    ],\n  },\n  lance: {\n    display: 'Lance',\n    tooltip: 'Specialized in mid-range attacks',\n    effects: [\n      {\n        display: 'Pierce',\n        tooltip: 'Pokes the enemy',\n        effects: [effectFunCall(['Basic:Attack', { amount: 2 }])],\n        priority: 3,\n        interruptible: true,\n        stamina: 2,\n        range: makeRange(0, 1, 2),\n      },\n      {\n        display: 'Charge!!',\n        tooltip: 'Runs towards the enemy to deal a massive blow',\n        effects: [\n          effectFunCall(['Basic:Move', { amount: -5 }]),\n          effectFunCall(['Basic:Attack', { amount: 4 }]),\n        ],\n        priority: 1,\n        interruptible: true,\n        stamina: 3,\n        range: makeRange(4),\n      },\n    ],\n  },\n  hammer: {\n    display: 'Hammer',\n    tooltip: 'Specialized in stunning',\n    effects: [\n      {\n        display: 'Head Banger',\n        tooltip: 'Hits the enemy in the head',\n        effects: [effectFunCall(['Basic:Attack', { amount: 2 }]), effectFunCall('Effect:Stun')],\n        priority: 4,\n        interruptible: true,\n        stamina: 4,\n        range: makeRange(0),\n      },\n      {\n        display: 'Large swing',\n        tooltip: 'Uses the inertia of the hammer to safely advance',\n        effects: [effectFunCall(['Basic:Move', { amount: -3 }]), effectFunCall('Effect:Stun')],\n        priority: 3,\n        interruptible: true,\n        stamina: 3,\n        range: makeRange(1, 2, 3),\n      },\n      {\n        display: 'Go for the ankles',\n        tooltip: 'Slows down the enemy',\n        effects: [\n          effectFunCall(['Effect:Stat', { target: 'Monster', speed: -1 }]),\n          effectFunCall('Effect:Stun'),\n        ],\n        priority: 4,\n        interruptible: true,\n        stamina: 6,\n        range: makeRange(1),\n      },\n    ],\n  },\n  claw: {\n    display: 'Finger Claw',\n    tooltip: 'Specialized in poison',\n    effects: [\n      {\n        display: 'Caress',\n        tooltip: 'Applies poison to the monster',\n        effects: [effectFunCall(['Effect:Poison', { target: 'Monster', turns: 2 }])],\n        priority: 3,\n        interruptible: false,\n        stamina: 2,\n        range: makeRange(0),\n      },\n      {\n        display: 'Backflip',\n        tooltip: 'Dodges an attack and moves backward',\n        effects: [effectFunCall('Effect:Dodge'), effectFunCall(['Basic:Move', { amount: 2 }])],\n        priority: 1,\n        interruptible: false,\n        stamina: 4,\n        range: makeRange(0, 1),\n      },\n    ],\n  },\n  bow: {\n    display: 'Bow',\n    tooltip: 'Specialized in ranged attacks',\n    effects: [\n      {\n        display: 'Relaxed Shot',\n        tooltip: 'Shoots an arrow',\n        effects: [effectFunCall(['Basic:Attack', { amount: 2 }])],\n        priority: 3,\n        interruptible: true,\n        stamina: 2,\n        range: makeRange(3, 4),\n      },\n      {\n        display: 'Power Draw',\n        tooltip: 'Shoots your strongest arrow and makes you weaker',\n        effects: [\n          effectFunCall(['Basic:Attack', { amount: 6 }]),\n          effectFunCall(['Effect:Stat', { target: 'Player', attack: -1 }]),\n        ],\n        priority: 3,\n        interruptible: true,\n        stamina: 4,\n        range: makeRange(4),\n      },\n    ],\n  },\n  staff: {\n    display: 'Magic Staff',\n    tooltip: 'Specialized in multiple attacks',\n    effects: [\n      {\n        display: 'Bolt',\n        tooltip: 'Shoots a low damage bolt',\n        effects: [effectFunCall(['Basic:Attack', { amount: 1 }])],\n        priority: 3,\n        interruptible: true,\n        stamina: 3,\n        range: allRanges,\n      },\n      {\n        display: 'Pew Pew Pew',\n        tooltip: 'Shoots a barrage of bolts',\n        effects: [\n          effectFunCall(['Basic:Attack', { amount: 1 }]),\n          effectFunCall(['Basic:Attack', { amount: 1 }]),\n          effectFunCall(['Basic:Attack', { amount: 1 }]),\n          effectFunCall(['Basic:Attack', { amount: 1 }]),\n        ],\n        priority: 4,\n        interruptible: true,\n        stamina: 8,\n        range: makeRange(2, 3, 4),\n      },\n    ],\n  },\n};\n\nexport default weapons as Weapons;\n","import { allRanges, selfRange } from '../makeGame';\nimport { BuildRepository, effectFunCall } from '../types';\nimport armors from './armors';\nimport charms from './charms';\nimport classes from './classes';\nimport consumables from './consumables';\nimport footwears from './footwears';\nimport headgears from './headgears';\nimport offhands from './offhand';\nimport skills from './skills';\nimport weapons from './weapons';\n\nconst build: BuildRepository = {\n  debug: {\n    disabled: {\n      display: 'None',\n    },\n    enabled: {\n      display: 'Debug',\n      effects: [\n        {\n          display: 'GGWP',\n          tooltip: 'Wins the game',\n          priority: 1,\n          interruptible: false,\n          stamina: 0,\n          range: allRanges,\n          effects: [effectFunCall('Debug:GGWP')],\n        },\n        {\n          display: 'SUDOKU',\n          tooltip: 'Loses the game',\n          priority: 1,\n          interruptible: false,\n          stamina: 0,\n          range: allRanges,\n          effects: [effectFunCall('Debug:Sudoku')],\n        },\n      ],\n    },\n  },\n  basic: {\n    basic: {\n      display: 'Basic',\n      effects: [\n        {\n          display: 'Rest',\n          tooltip: 'Skip the turn and restore stamina',\n          priority: 4,\n          interruptible: false,\n          stamina: 0,\n          range: selfRange,\n          effects: [effectFunCall('Basic:Rest')],\n        },\n        {\n          display: 'Advance',\n          tooltip: 'Move closer',\n          priority: 4,\n          interruptible: false,\n          stamina: 1,\n          range: selfRange,\n          effects: [effectFunCall(['Basic:Move', { amount: -1 }])],\n        },\n        {\n          display: 'Retreat',\n          tooltip: 'Move farther',\n          effects: [effectFunCall(['Basic:Move', { amount: 1 }])],\n          priority: 4,\n          interruptible: false,\n          stamina: 1,\n          range: selfRange,\n        },\n      ],\n    },\n  },\n  class: classes,\n  skill: skills,\n  weapon: weapons,\n  offhand: offhands,\n  armor: armors,\n  headgear: headgears,\n  footwear: footwears,\n  charm: charms,\n  consumable: consumables,\n};\n\nexport default build;\n","import { updateGlobals } from './modding';\nimport { BuildRepository, EnemyRepository } from './types';\nimport enemyRepository from './data/enemies';\nimport buildRepository from './data/build';\n\nexport const enemies: EnemyRepository = enemyRepository;\nexport const build: BuildRepository = buildRepository;\n\nupdateGlobals({ build, enemies });\n","import { Range } from 'immutable';\nimport { Tuple } from './types';\n\nexport const rangeArr = (max: number, min: number = 0) => {\n  let range = [...Array(max).keys()];\n  if (min >= 0) {\n    range.filter((i) => i < min);\n  }\n  return range;\n};\n\nexport const clamp = (num: number, min: number, max: number = Infinity) =>\n  Math.min(Math.max(num, min), max);\n\nexport const pipe = <T, U>(t: T, f: (t: T) => U): U => f(t);\n\nexport const pipe2 = <T, U, A>(t: T, u: U, f: (t: T, u: U) => A): A => f(t, u);\n\nexport const pipe3 = <T, U, V, A>(t: T, u: U, v: V, f: (t: T, u: U, v: V) => A): A => f(t, u, v);\n\nexport const chunk = <T, N extends number>(list: T[], chunkSize: N): Tuple<T, N>[] =>\n  Range(0, list.length, chunkSize)\n    .map((chunkStart) => list.slice(chunkStart, chunkStart + chunkSize))\n    .toArray() as Tuple<T, N>[];\n","import { EffectFunctionRepository } from './effectRepository';\nimport { BuildRepository, effectFunCall, EnemyInfo, EnemyRepository, Play } from './types';\n\nexport type Globals = {\n  debug: boolean;\n  trainingEnemy: EnemyInfo;\n  build?: BuildRepository;\n  effects?: EffectFunctionRepository;\n  enemies?: EnemyRepository;\n  ingame?: {\n    game: Play;\n    forceUpdate: () => void;\n  };\n};\n\nconst globalsDefault: Globals = {\n  debug: false,\n  trainingEnemy: [\n    {\n      lore: {\n        name: '🤖 Dummy 🤖',\n      },\n      effects: [\n        {\n          display: 'Approve of your life choices',\n          tooltip: \"You're doing great!\",\n          priority: 4,\n          effects: [effectFunCall(['Monster:Attack', { amount: 0 }])],\n          interruptible: true,\n          range: [0, 1, 2, 3, 4],\n        },\n      ],\n      rolls: [[0], [0], [0], [0], [0]],\n    },\n    {\n      hp: { current: 300, starting: 300, max: 300 },\n      distance: 0,\n      speed: { current: 0, starting: 0, max: 0 },\n      attack: { current: 0, starting: 0, max: 0 },\n      defence: { current: 0, starting: 0, max: 0 },\n      status: {\n        dodge: { active: false },\n        armor: { amount: 0 },\n        bleed: { turns: 0 },\n        stun: { active: false },\n      },\n    },\n  ],\n};\n\nexport const globals = (): Globals =>\n  // @ts-ignore\n  globalThis.__buildmancer;\n\nexport const updateGlobals = (p: Partial<Globals>) => {\n  const theThis = globalThis as unknown as { __buildmancer: Globals };\n  theThis.__buildmancer = {\n    ...globalsDefault,\n    ...(theThis.__buildmancer ?? {}),\n    ...p,\n  };\n};\n\nupdateGlobals({});\n","import { Opaque } from 'type-fest';\nimport { Armors } from './data/armors';\nimport { Charms } from './data/charms';\nimport { Classes } from './data/classes';\nimport { Consumables } from './data/consumables';\nimport { EnemiesIndex } from './data/enemies';\nimport { Footwears } from './data/footwears';\nimport { Headgears } from './data/headgears';\nimport { Offhands } from './data/offhand';\nimport { Skills } from './data/skills';\nimport { Weapons } from './data/weapons';\nimport {\n  EffectFunParams,\n  EffectFunctionRepository,\n  EffectFunRepoIndex,\n  StatsFunIndex,\n} from './effectRepository';\n\nexport type Tuple<T, N extends number> = N extends N\n  ? number extends N\n    ? T[]\n    : _TupleOf<T, N, []>\n  : never;\ntype _TupleOf<T, N extends number, R extends unknown[]> = R['length'] extends N\n  ? R\n  : _TupleOf<T, N, [T, ...R]>;\n\nexport type Nel<T> = [T, ...T[]];\n\ntype Length<T extends any[]> = T extends { length: infer L } ? L : never;\ntype BuildTuple<L extends number, T extends any[] = []> = T extends {\n  length: L;\n}\n  ? T\n  : BuildTuple<L, [...T, any]>;\nexport type Subtract<A extends number, B extends number> = BuildTuple<A> extends [\n  ...infer U,\n  ...BuildTuple<B>\n]\n  ? Length<U>\n  : never;\ntype EQ<A, B> = A extends B ? (B extends A ? true : false) : false;\ntype AtTerminus<A extends number, B extends number> = A extends 0\n  ? true\n  : B extends 0\n  ? true\n  : false;\ntype LT<A extends number, B extends number> = AtTerminus<A, B> extends true\n  ? EQ<A, B> extends true\n    ? false\n    : A extends 0\n    ? true\n    : false\n  : LT<Subtract<A, 1>, Subtract<B, 1>>;\n\nexport type TupleUpTo<T, N extends number> = EQ<N, 1> extends true\n  ? [T]\n  : TupleUpTo<T, Subtract<N, 1>> | Tuple<T, N>;\n\nexport type UpTo<N extends number> = EQ<N, 0> extends true ? 0 : UpTo<Subtract<N, 1>> | N;\n\nexport interface Stat {\n  max: number;\n  starting: number;\n  current: UpTo<Stat['max']>;\n}\n\nexport interface Status {\n  dodge: { active: boolean };\n  stun: { active: boolean };\n  armor: { amount: number };\n  bleed: { turns: number };\n}\nexport interface PlayerStats {\n  hp: Stat;\n  stamina: Stat;\n  staminaPerTurn: Stat;\n  speed: Stat;\n  attack: Stat;\n  defence: Stat;\n  status: Status;\n}\nexport interface EnemyStats {\n  hp: Stat;\n  speed: Stat;\n  attack: Stat;\n  defence: Stat;\n  distance: UpTo<Subtract<Distances, 1>>;\n  status: Status;\n}\nexport type InventoryStats = {\n  [k in Item['display']]: { used: number };\n};\n\nexport type Priorities = 5;\nexport type Distances = 5;\nexport type MonsterCount = 5;\nexport type Staminas = 10;\n\nexport type EffectPhase = 'MAIN' | 'BOT' | 'EOT' | 'CLEANUP';\nexport interface EffectSummary {\n  origin: Target;\n  display: string;\n  phase: EffectPhase;\n}\n\nexport type DisabledSkills = (keyof BuildRepository)[];\nexport interface Snapshot {\n  player: PlayerStats;\n  enemies: EnemiesStats;\n  inventory: InventoryStats;\n  target: MonsterTarget;\n  lastAttacks: EffectSummary[];\n  bot?: Nel<[Target, Effect]>;\n  eot?: Nel<[Target, Effect]>;\n  disabledSkills: DisabledSkills;\n}\n\nexport type RNG = Opaque<number[][], 'RNG'>;\n\nexport type VersionString = '1';\nexport type Seed = number | string;\nexport interface Play {\n  states: Nel<Snapshot>;\n  player: Player;\n  enemies: Enemies;\n  rng: RNG;\n  turns: number;\n  id: string;\n  seed: Seed;\n  version: VersionString;\n}\n\ntype ItemOrMonster = string /* TODO all items */ | 'Monster';\nexport type FunIndex = `${ItemOrMonster}:${string}`;\n\nexport type StatsFunRepo = { [key in StatsFunIndex]: StatsFun };\nexport type StatsFun = (player: PlayerStats, enemies: EnemiesStats) => [PlayerStats, EnemiesStats];\n\nexport type Ranges = UpTo<Subtract<Distances, 1>>[];\n\ninterface EffectFunCallT {\n  index: EffectFunRepoIndex;\n  parameters: EffectFunParams<EffectFunRepoIndex>;\n}\nexport type EffectFunCall = Opaque<EffectFunCallT, EffectFunCallT>;\nexport const effectFunCall = <T extends EffectFunRepoIndex>(\n  t: EffectFunParams<T> extends undefined ? T : [T, EffectFunParams<T>]\n): EffectFunCall =>\n  (Array.isArray(t)\n    ? { index: t[0], parameters: t[1] }\n    : { index: t, parameters: undefined }) as EffectFunCall;\nexport const callEffectFun = <T extends EffectFunRepoIndex>(\n  repo: EffectFunctionRepository,\n  t: T,\n  p: EffectFunParams<T>\n) => {\n  const f = repo[t];\n  // @ts-expect-error: index and parameters are enforced to be compatible at construction and the runtime check above ^^^^\n  return f(p);\n};\n\nexport interface Effect {\n  display: string;\n  tooltip: string;\n  effects: Nel<EffectFunCall>;\n  priority: UpTo<Subtract<Priorities, 1>>;\n  range: Ranges;\n  interruptible: boolean;\n}\nexport interface InventoryEffect extends Effect {\n  stamina: UpTo<Subtract<Staminas, 1>>;\n  amount?: number;\n}\n\nexport type MonsterTarget = UpTo<Subtract<MonsterCount, 1>>;\nexport type PlayerTarget = 'Player';\nexport type Target = MonsterTarget | PlayerTarget;\n\nexport type EffectTarget = 'Player' | 'Monster';\nexport type PlayerStatParameter = Partial<{\n  [k in keyof Omit<PlayerStats, 'status'>]: number;\n}>;\nexport type MonsterStatParameter = Partial<{\n  [k in keyof Omit<EnemyStats, 'status'>]: number;\n}>;\nexport type StatEffectTarget =\n  | (PlayerStatParameter & { target: 'Player' })\n  | (MonsterStatParameter & { target: 'Monster' });\n\nexport interface BuildRepository {\n  debug: { enabled: Item; disabled: Item };\n  basic: { basic: Item };\n  class: Classes;\n  skill: Skills;\n  weapon: Weapons;\n  offhand: Offhands;\n  consumable: Consumables;\n  armor: Armors;\n  headgear: Headgears;\n  footwear: Footwears;\n  charm: Charms;\n}\nexport type Build = {\n  [k in keyof BuildRepository]: Item;\n};\n\nexport type EnemyInfo = [Enemy, EnemyStats];\nexport type EnemyRepository = { [k in EnemiesIndex]: EnemyInfo };\n\nexport interface Item {\n  display: string;\n  tooltip?: string;\n  passives?: StatsFunIndex[];\n  bot?: Nel<InventoryEffect>;\n  eot?: Nel<InventoryEffect>;\n  effects?: Nel<InventoryEffect>;\n}\n\nexport interface Player {\n  id: string;\n  lore: Record<string, string | number>;\n  build: Build;\n}\n\n// Place in the array for now\ntype EffectIdentity = number;\nexport interface Enemy {\n  lore: Record<string, string | number>;\n  effects: Nel<Effect>;\n  rolls: Tuple<EffectIdentity[], Distances>;\n  bot?: Nel<Effect>;\n  eot?: Nel<Effect>;\n}\n\nexport type Enemies = TupleUpTo<Enemy, MonsterCount>;\nexport type EnemiesStats = TupleUpTo<EnemyStats, MonsterCount>;\n\nexport const safeEntries = <T, K extends keyof T>(o: {\n  [s in K]: T[s];\n}): [K, T[K]][] => Object.entries(o).map(([k, v]) => [k as K, v as T[K]]);\n\nexport const safeValues = <T, K extends keyof T>(o: {\n  [s in K]: T[s];\n}): T[K][] => safeEntries(o).map((a) => a[1]);\n\nexport const safeKeys = <T, K extends keyof T>(o: {\n  [s in K]: T[s];\n}): K[] => safeEntries(o).map((a) => a[0]);\n","const names = [\n  'Lydan',\n  'Syrin',\n  'Ptorik',\n  'Joz',\n  'Varog',\n  'Gethrod',\n  'Hezra',\n  'Feron',\n  'Ophni',\n  'Colborn',\n  'Fintis',\n  'Gatlin',\n  'Jinto',\n  'Hagalbar',\n  'Krinn',\n  'Lenox',\n  'Revvyn',\n  'Hodus',\n  'Dimian',\n  'Paskel',\n  'Kontas',\n  'Weston',\n  'Azamarr',\n  'Jather',\n  'Tekren',\n  'Jareth',\n  'Adon',\n  'Zaden',\n  'Eune',\n  'Graff',\n  'Tez',\n  'Jessop',\n  'Gunnar',\n  'Pike',\n  'Domnhar',\n  'Baske',\n  'Jerrick',\n  'Mavrek',\n  'Riordan',\n  'Wulfe',\n  'Straus',\n  'Tyvrik',\n  'Henndar',\n  'Favroe',\n  'Whit',\n  'Jaris',\n  'Renham',\n  'Kagran',\n  'Lassrin',\n  'Vadim',\n  'Arlo',\n  'Quintis',\n  'Vale',\n  'Caelan',\n  'Yorjan',\n  'Khron',\n  'Ishmael',\n  'Jakrin',\n  'Fangar',\n  'Roux',\n  'Baxar',\n  'Hawke',\n  'Gatlen',\n  'Barak',\n  'Nazim',\n  'Kadric',\n  'Paquin',\n  'Kent',\n  'Moki',\n  'Rankar',\n  'Lothe',\n  'Ryven',\n  'Clawsen',\n  'Pakker',\n  'Embre',\n  'Cassian',\n  'Verssek',\n  'Dagfinn',\n  'Ebraheim',\n  'Nesso',\n  'Eldermar',\n  'Rivik',\n  'Rourke',\n  'Barton',\n  'Hemm',\n  'Sarkin',\n  'Blaiz',\n  'Talon',\n  'Agro',\n  'Zagaroth',\n  'Turrek',\n  'Esdel',\n  'Lustros',\n  'Zenner',\n  'Baashar',\n  'Dagrod',\n  'Gentar',\n  'Feston',\n  'Syrana',\n  'Resha',\n  'Varin',\n  'Wren',\n  'Yuni',\n  'Talis',\n  'Kessa',\n  'Magaltie',\n  'Aeris',\n  'Desmina',\n  'Krynna',\n  'Asralyn',\n  'Herra',\n  'Pret',\n  'Kory',\n  'Afia',\n  'Tessel',\n  'Rhiannon',\n  'Zara',\n  'Jesi',\n  'Belen',\n  'Rei',\n  'Ciscra',\n  'Temy',\n  'Renalee',\n  'Estyn',\n  'Maarika',\n  'Lynorr',\n  'Tiv',\n  'Annihya',\n  'Semet',\n  'Tamrin',\n  'Antia',\n  'Reslyn',\n  'Basak',\n  'Vixra',\n  'Pekka',\n  'Xavia',\n  'Beatha',\n  'Yarri',\n  'Liris',\n  'Sonali',\n  'Razra',\n  'Soko',\n  'Maeve',\n  'Everen',\n  'Yelina',\n  'Morwena',\n  'Hagar',\n  'Palra',\n  'Elysa',\n  'Sage',\n  'Ketra',\n  'Lynx',\n  'Agama',\n  'Thesra',\n  'Tezani',\n  'Ralia',\n  'Esmee',\n  'Heron',\n  'Naima',\n  'Rydna',\n  'Sparrow',\n  'Baakshi',\n  'Ibera',\n  'Phlox',\n  'Dessa',\n  'Braithe',\n  'Taewen',\n  'Larke',\n  'Silene',\n  'Phressa',\n  'Esther',\n  'Anika',\n  'Rasy',\n  'Harper',\n  'Indie',\n  'Vita',\n  'Drusila',\n  'Minha',\n  'Surane',\n  'Lassona',\n  'Merula',\n  'Kye',\n  'Jonna',\n  'Lyla',\n  'Zet',\n  'Orett',\n  'Naphtalia',\n  'Turi',\n  'Rhays',\n  'Shike',\n  'Hartie',\n  'Beela',\n  'Leska',\n  'Vemery',\n  'Lunex',\n  'Fidess',\n  'Tisette',\n  'Partha',\n];\n\nexport default names;\n","import { enemies, build } from './data';\nimport { Chance } from 'chance';\nimport names from './data/names';\nimport { globals } from './modding';\nimport {\n  UpTo,\n  Subtract,\n  Distances,\n  Ranges,\n  Stat,\n  Status,\n  EnemyInfo,\n  Build,\n  PlayerStats,\n  Player,\n  safeValues,\n} from './types';\n\nexport const makeRange = (...number: UpTo<Subtract<Distances, 1>>[]) =>\n  [...new Set(number)] as Ranges;\nexport const allRanges = makeRange(0, 1, 2, 3, 4);\nexport const selfRange = allRanges;\n\nexport const makeStat = (\n  amount: number,\n  max: (amt: number) => number = (amt) => amt + 10\n): Stat => ({\n  current: amount,\n  starting: amount,\n  max: max(amount),\n});\nexport const defaultStatus: Status = {\n  dodge: { active: false },\n  armor: { amount: 0 },\n  bleed: { turns: 0 },\n  stun: { active: false },\n};\n\nexport const randomEnemy = (): EnemyInfo => new Chance().pickone(safeValues(enemies));\nexport const dummyEnemy = (): EnemyInfo => globals().trainingEnemy;\n\nexport const randomName = () => names[Math.floor(Math.random() * names.length)];\n\nexport const randomBuild = (rng: Chance.Chance, buildOverride?: Partial<Build>) => ({\n  debug: build.debug[globals().debug ? 'enabled' : 'disabled'],\n  basic: rng.pickone(safeValues(build.basic)),\n  class: rng.pickone(safeValues(build.class)),\n  skill: rng.pickone(safeValues(build.skill)),\n  armor: rng.pickone(safeValues(build.armor)),\n  weapon: rng.pickone(safeValues(build.weapon)),\n  offhand: rng.pickone(safeValues(build.offhand)),\n  footwear: rng.pickone(safeValues(build.footwear)),\n  headgear: rng.pickone(safeValues(build.headgear)),\n  charm: rng.pickone(safeValues(build.charm)),\n  consumable: rng.pickone(safeValues(build.consumable)),\n  ...buildOverride,\n});\n\nexport const playerStatsDefault: PlayerStats = {\n  hp: makeStat(15),\n  stamina: makeStat(6, (a) => a),\n  staminaPerTurn: makeStat(2),\n  speed: makeStat(0),\n  attack: makeStat(0),\n  defence: makeStat(0),\n  status: defaultStatus,\n};\n\nexport const randomPlayer = (\n  statsOverride?: Partial<PlayerStats>,\n  buildOverride?: Partial<Build>\n): [Player, PlayerStats] => {\n  const rng = new Chance();\n  return [\n    {\n      id: rng.string(),\n      lore: {\n        name: randomName(),\n        age: rng.age(),\n      },\n      build: randomBuild(rng, buildOverride),\n    },\n    {\n      ...playerStatsDefault,\n      ...statsOverride,\n    },\n  ];\n};\n","import WebSocket from 'ws';\nimport { assign, createMachine, interpret } from 'xstate';\nimport { inspect } from '@xstate/inspect/lib/server.js';\nimport { scoreGame } from '../game/playGame';\n\nconst isDebug = process && process.env['SMD'] === '1';\n\nif (isDebug) {\n  inspect({\n    server: new WebSocket.Server({\n      port: 8888,\n    }),\n  });\n}\n\nconst toMenu = {\n  on: {\n    MENU: { target: 'main' },\n  },\n};\n\nconst quick = {\n  initial: 'play',\n  states: {\n    play: {\n      entry: ['reset'],\n      on: {\n        WIN: { target: 'win' },\n        LOSE: { target: 'lose' },\n      },\n    },\n    win: { type: 'final' as const },\n    lose: { type: 'final' as const },\n  },\n  ...toMenu,\n};\n\nconst single = {\n  initial: 'player',\n  states: {\n    player: {\n      entry: ['reset'],\n      on: {\n        PLAYER: { target: 'encounter' },\n      },\n    },\n    encounter: {\n      on: {\n        ENCOUNTER: { target: 'play' },\n      },\n    },\n    play: {\n      on: {\n        WIN: { target: 'win' },\n        LOSE: { target: 'lose' },\n      },\n    },\n    win: { type: 'final' as const },\n    lose: { type: 'final' as const },\n  },\n  ...toMenu,\n};\n\nconst arcade = {\n  initial: 'player',\n  states: {\n    player: {\n      entry: ['reset'],\n      on: {\n        PLAYER: { target: 'play' },\n      },\n    },\n    play: {\n      on: {\n        WIN: [\n          { target: 'victory', cond: 'isFinal' },\n          {\n            target: 'play',\n            actions: ['bumpVictories', 'bumpScore'],\n            internal: true,\n          },\n        ],\n        LOSE: { target: 'defeat' },\n      },\n    },\n    victory: {\n      type: 'final' as const,\n    },\n    defeat: {\n      type: 'final' as const,\n    },\n  },\n  ...toMenu,\n};\n\nconst survival = {\n  initial: 'player',\n  states: {\n    player: {\n      entry: ['reset'],\n      on: {\n        PLAYER: { target: 'play' },\n      },\n    },\n    play: {\n      on: {\n        WIN: { target: 'play', actions: ['bumpVictories'] },\n        LOSE: { target: 'defeat' },\n      },\n    },\n    defeat: {\n      type: 'final' as const,\n      on: {\n        // ACK: { target: '#menus.leaderboards' }\n      },\n    },\n  },\n  ...toMenu,\n};\n\nconst puzzle = {\n  initial: 'puzzle',\n  states: {\n    puzzle: {\n      on: {\n        PLAYER: { target: 'player' },\n      },\n    },\n    player: {\n      on: {\n        SELECTED: { target: 'play' },\n      },\n    },\n    play: {\n      on: {\n        COMPLETE: { target: 'complete' },\n      },\n    },\n    complete: {\n      on: {\n        NEXT: { target: 'player' },\n        SELECT: { target: 'puzzle' },\n      },\n    },\n  },\n  ...toMenu,\n};\n\nconst replay = {\n  initial: 'replay',\n  states: {\n    replay: {\n      on: {\n        REPLAY: { target: 'play' },\n      },\n    },\n    play: {\n      on: {\n        WIN: { target: 'win' },\n        LOSE: { target: 'lose' },\n      },\n    },\n    win: { type: 'final' as const },\n    lose: { type: 'final' as const },\n  },\n  ...toMenu,\n};\n\nconst training = {\n  initial: 'player',\n  states: {\n    player: {\n      entry: ['reset'],\n      on: {\n        PLAYER: { target: 'play' },\n      },\n    },\n    play: {\n      on: {\n        WIN: { target: 'win' },\n        LOSE: { target: 'lose' },\n      },\n    },\n    win: { type: 'final' as const },\n    lose: { type: 'final' as const },\n  },\n  ...toMenu,\n};\n\nconst makeArcadeContext = () => ({\n  victories: 0,\n  score: 0,\n  seed: Math.random(),\n});\nconst makeSurvivalContext = () => ({\n  victories: 0,\n  seed: Math.random(),\n});\nconst makeSingleContext = () => ({\n  seed: Math.random(),\n});\nconst makeGameContext = () => ({\n  arcadeContext: makeArcadeContext(),\n  survivalContext: makeSurvivalContext(),\n  singleContext: makeSingleContext(),\n});\n\nexport const gameMenuMachine = createMachine(\n  {\n    tsTypes: {} as import('./menuStateMachine.typegen').Typegen0,\n    id: 'menus',\n    initial: 'main',\n    context: makeGameContext(),\n    states: {\n      main: {\n        on: {\n          QUICK: { target: 'quick' },\n          SINGLE: { target: 'single' },\n          TRAINING: { target: 'training' },\n          ARCADE: { target: 'arcade' },\n          SURVIVAL: { target: 'survival' },\n          REPLAY: { target: 'replay' },\n          // PUZZLE: { target: 'puzzle' },\n          // LEADERBOARDS: { target: 'leaderboards' },\n        },\n      },\n      quick: {\n        ...quick,\n      },\n      single: {\n        ...single,\n      },\n      arcade: {\n        ...arcade,\n      },\n      survival: {\n        ...survival,\n      },\n      replay: {\n        ...replay,\n      },\n      training: {\n        ...training,\n      },\n      // puzzle: {\n      //   ...puzzle,\n      // },\n      // leaderboards: {\n      //   ...toMenu,\n      // }\n    },\n  },\n  {\n    guards: {\n      isFinal: ({ arcadeContext: { victories } }) => victories + 1 >= 7,\n    },\n    actions: {\n      bumpVictories: assign({\n        arcadeContext: ({ arcadeContext }, _event) => ({\n          ...arcadeContext,\n          victories: arcadeContext.victories + 1,\n          seed: Math.random(),\n        }),\n        survivalContext: ({ survivalContext }, _event) => ({\n          ...survivalContext,\n          victories: survivalContext.victories + 1,\n          seed: Math.random(),\n        }),\n      }),\n      bumpScore: assign({\n        arcadeContext: ({ arcadeContext }, { game }) => ({\n          ...arcadeContext,\n          score: arcadeContext.score + scoreGame(game),\n          seed: Math.random(),\n        }),\n      }),\n      reset: assign({\n        survivalContext: (c, e) => makeSurvivalContext(),\n        arcadeContext: (c, e) => makeArcadeContext(),\n        singleContext: (c, e) => makeSingleContext(),\n      }),\n    },\n  }\n);\n\nif (isDebug) {\n  interpret(gameMenuMachine, { devTools: true })\n    .onTransition((state) => console.log(state))\n    .start();\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process && process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://cra.link/PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://cra.link/PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n"],"sourceRoot":""}